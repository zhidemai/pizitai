(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-319b","chunk-a259","chunk-1137","chunk-e306","chunk-11379","chunk-7e46","chunk-11379b","chunk-5494"],{"+3hb":function(t,e,a){"use strict";var i=a("QTVK");a.n(i).a},"+9th":function(t,e,a){"use strict";a.d(e,"p",function(){return s}),a.d(e,"n",function(){return n}),a.d(e,"a",function(){return l}),a.d(e,"h",function(){return o}),a.d(e,"j",function(){return c}),a.d(e,"l",function(){return r}),a.d(e,"m",function(){return d}),a.d(e,"u",function(){return u}),a.d(e,"s",function(){return m}),a.d(e,"f",function(){return h}),a.d(e,"d",function(){return p}),a.d(e,"k",function(){return f}),a.d(e,"g",function(){return v}),a.d(e,"q",function(){return g}),a.d(e,"t",function(){return _}),a.d(e,"r",function(){return b}),a.d(e,"o",function(){return y}),a.d(e,"e",function(){return w}),a.d(e,"b",function(){return C}),a.d(e,"c",function(){return x}),a.d(e,"i",function(){return D});var i=a("t3Un");function s(t){return Object(i.a)({url:"oa/task/subTaskList",method:"post",data:t})}function n(t){return Object(i.a)({url:"oa/task/myTask",method:"post",data:t})}function l(t){return Object(i.a)({url:"oa/task/save",method:"post",data:t})}function o(t){return Object(i.a)({url:"oa/task/delete",method:"post",data:t})}function c(t){return Object(i.a)({url:"oa/task/read",method:"post",data:t})}function r(t){return Object(i.a)({url:"oa/task/update",method:"post",data:t})}function d(t){return Object(i.a)({url:"oa/task/updateName",method:"post",data:t})}function u(t){return Object(i.a)({url:"oa/task/updateStoptime",method:"post",data:t})}function m(t){return Object(i.a)({url:"oa/task/updateOwner",method:"post",data:t})}function h(t){return Object(i.a)({url:"oa/task/updateLable",method:"post",data:t})}function p(t){return Object(i.a)({url:"oa/tasklable/save",method:"post",data:t})}function f(t){return Object(i.a)({url:"oa/tasklable/update",method:"post",data:t})}function v(t){return Object(i.a)({url:"oa/tasklable/delete",method:"post",data:t})}function g(t){return Object(i.a)({url:"oa/tasklable/index",method:"post",data:t})}function _(t){return Object(i.a)({url:"oa/task/updatePriority",method:"post",data:t})}function b(t){return Object(i.a)({url:"oa/task/taskOver",method:"post",data:t})}function y(t){return Object(i.a)({url:"oa/task/readLoglist",method:"post",data:t})}function w(t){return Object(i.a)({url:"oa/task/delOwnerById",method:"post",data:t})}function C(t){return Object(i.a)({url:"oa/taskcomment/save",method:"post",data:t})}function x(t){return Object(i.a)({url:"oa/taskcomment/delete",method:"post",data:t})}function D(t){return Object(i.a)({url:"oa/task/delrelation",method:"post",data:t})}},"+NTD":function(t,e,a){"use strict";var i=a("YEIV"),s=a.n(i),n=a("mX3o"),l=a("EgJF"),o=a("ooHJ"),c=a("7Qib"),r={name:"relative-return-money",components:{CRMCreateView:l.default,CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-682f"),a.e("chunk-6f45"),a.e("chunk-a259"),a.e("chunk-1137")]).then(a.bind(null,"uMjE"))}},computed:{},mixins:[n.a],data:function(){return{list:[],fieldList:[],tableHeight:"250px",showFullDetail:!1,showFullCrmType:"receivables",showFullId:"",createCrmType:"receivables_plan",isCreate:!1,palnList:[],planFieldList:[],createActionInfo:{type:"relative",crmType:this.crmType,data:{}}}},watch:{id:function(t){this.list=[],this.palnList=[],this.getList(),this.getPlanList()}},props:{id:[String,Number],crmType:{type:String,default:""},detail:{type:Object,default:function(){return{}}}},mounted:function(){this.planFieldList=[{prop:"num",width:"200",label:"期数"},{prop:"customer_id",width:"200",label:"客户名称"},{prop:"contract_id",width:"200",label:"合同编号"},{prop:"money",width:"200",label:"计划回款金额"},{prop:"return_date",width:"200",label:"计划回款日期"},{prop:"return_type",width:"200",label:"计划回款方式"},{prop:"remind",width:"200",label:"提前几日提醒"},{prop:"remark",width:"200",label:"备注"}],this.getPlanList(),this.fieldList=[{prop:"number",width:"200",label:"回款编号"},{prop:"contract_id",width:"200",label:"合同名称"},{prop:"contract_money",width:"200",label:"合同金额"},{prop:"money",width:"200",label:"回款金额"},{prop:"owner_user_id",width:"200",label:"负责人"},{prop:"check_status_info",width:"200",label:"状态"},{prop:"return_time",width:"200",label:"回款日期"}],this.getList()},activated:function(){},deactivated:function(){},methods:s()({getPlanList:function(){var t=this;this.loading=!0,Object(o.d)(this.getParams()).then(function(e){t.loading=!1,t.palnList=e.data.list}).catch(function(){t.loading=!1})},getList:function(){var t=this;this.loading=!0,Object(o.c)(this.getParams()).then(function(e){t.loading=!1,t.list=e.data.list}).catch(function(){t.loading=!1})},getParams:function(){return"customer"===this.crmType?{customer_id:this.id,pageType:"all"}:"contract"===this.crmType?{contract_id:this.id,pageType:"all"}:{}},handleRowClick:function(t,e,a){this.showFullId=t.receivables_id,this.showFullCrmType="receivables",this.showFullDetail=!0},planHandleRowClick:function(t,e,a){},cellStyle:function(t){t.row,t.column,t.rowIndex;return 1==t.columnIndex?{color:"#3E84E9"}:""},createClick:function(t){"money"==t?("contract"===this.crmType?(this.createActionInfo.data.customer=this.detail.customer_id_info,this.createActionInfo.data.contract=this.detail):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables",this.isCreate=!0):"plan"==t&&("contract"===this.crmType?(this.createActionInfo.data.customer=this.detail.customer_id_info,this.createActionInfo.data.contract=this.detail):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables_plan",this.isCreate=!0)},saveSuccess:function(){"receivables"==this.createCrmType?this.getList():this.getPlanList()},fieldFormatter:function(t,e){return"contract_id"===e.property?t.contract_id_info.name:"customer_id"===e.property?t.customer_id_info.name:"create_time"===e.property?Object(c.m)(t.customer_id_info.create_time):"owner_user_id"===e.property?t.owner_user_id_info.realname:t[e.property]},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}}},"cellStyle",function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}})},d=(a("6PAh"),a("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rc-cont"},[a("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.createClick("plan")}}},[t._v("新建回款计划")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.palnList,height:t.tableHeight,stripe:"","header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle},on:{"row-click":t.planHandleRowClick}},t._l(t.planFieldList,function(e,i){return a("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",prop:e.prop,formatter:t.fieldFormatter,label:e.label}})})),t._v(" "),a("flexbox",{staticClass:"rc-head",staticStyle:{"margin-top":"15px"},attrs:{direction:"row-reverse"}},[a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.createClick("money")}}},[t._v("新建回款")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,stripe:"","header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(e,i){return a("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",prop:e.prop,formatter:t.fieldFormatter,label:e.label}})})),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.showFullCrmType,id:t.showFullId},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?a("c-r-m-create-view",{attrs:{"crm-type":t.createCrmType,action:t.createActionInfo},on:{"save-success":t.saveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"128d5b6e",null);u.options.__file="RelativeReturnMoney.vue";e.a=u.exports},"+QVO":function(t,e,a){"use strict";var i=a("/ECs");a.n(i).a},"+kCF":function(t,e,a){},"/ECs":function(t,e,a){},"0Ylm":function(t,e,a){"use strict";var i=a("AMVD");a.n(i).a},"0djP":function(t,e,a){},"18jM":function(t,e,a){"use strict";var i=a("HF+F");a.n(i).a},"1RnH":function(t,e,a){"use strict";var i=a("+9th"),s=a("mkuN"),n=a("Er7M"),l=a("7Qib"),o={components:{CrmRelative:s.a,RelatedBusinessCell:n.a},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customer_ids:[],contract_ids:[],contacts_ids:[],business_ids:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},watch:{allData:function(){this.relatedListData=this.allData}},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(t){var e=this;this.showPopover=!1,this.relatedListData=t.data;var a=function(a){var i=t.data[a];e.relevanceAll[a+"_ids"]=i.map(function(t,e,i){return t[a+"_id"]})};for(var i in t.data)a(i);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(t,e,a){var s=this;this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(i.i)({task_id:s.taskID,type:{customer:1,contacts:2,business:3,contract:4}[t],id:a[t+"_id"]}).then(function(a){s.relatedListData[t].splice(e,1),s.relatedListData=Object(l.h)(s.relatedListData),s.$message.success("关联取消成功")}).catch(function(){})}).catch(function(){s.$message.info("已取消操作")})},checkRelatedDetail:function(t,e){e.key=e[t+"_id"],this.$emit("checkRelatedDetail",t,e)}}},c=(a("SbwO"),a("KHd+")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"related-business",style:{"margin-left":t.marginLeft}},[!t.isTask&&t.alterable?i("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showRelative?i("crm-relative",{ref:"crmrelative",attrs:{show:t.showPopover,radio:!1,selectedData:t.relatedListData,showTypes:t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),i("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showRelative=!0}},slot:"reference"},[i("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n      关联业务\n    ")])],1):t._e(),t._v(" "),t.alterable?t._e():i("p",{staticClass:"alterable-p",style:{color:t.alterableColor}},[t._v("关联业务")]),t._v(" "),t._l(t.relatedListData,function(e,a){return i("div",{key:a},t._l(e,function(e,s){return i("related-business-cell",{key:s,attrs:{data:e,cellIndex:s,type:a,showFoot:t.isTask},on:{unbind:t.delRelevance,detail:function(i){t.checkRelatedDetail(a,e)}}})}))}),t._v(" "),t.isTask?i("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showTaskRelative?i("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:t.showPopover,selectedData:t.relatedListData,showTypes:t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),i("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showTaskRelative=!0}},slot:"reference"},[i("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n      关联业务\n    ")])],1):t._e()],2)},[],!1,null,"a1b65e4a",null);r.options.__file="relatedBusiness.vue";e.a=r.exports},"1qNb":function(t,e,a){},"4f+9":function(t,e,a){"use strict";var i=a("mYOy");a.n(i).a},"51oS":function(t,e,a){},"6PAh":function(t,e,a){"use strict";var i=a("FFAi");a.n(i).a},"6ZrO":function(t,e,a){},"753O":function(t,e,a){},"7z+D":function(t,e,a){"use strict";var i=a("ExMk"),s=a("KTTK"),n=a("Ew9n"),l=a("EP+0"),o=a("3biH"),c=a("Er7M"),r=a("O1Uw"),d=(a("wd/R"),a("7Qib")),u={name:"examine-detail",components:{SlideView:n.a,CreateSections:l.a,ExamineInfo:o.a,RelatedBusinessCell:c.a,CRMFullScreenDetail:function(){return a.e("chunk-5494").then(a.bind(null,"uMjE"))},FileCell:r.a},props:{id:[String,Number],noListenerClass:{type:Array,default:function(){return["list-box"]}}},watch:{id:function(t){this.getDetial()}},data:function(){return{loading:!1,category_id:"",detail:{},list:[],category_name:"",fileList:[],imgList:[],travelList:[],travelField:[{prop:"vehicle",label:"交通工具"},{prop:"trip",label:"单程往返"},{prop:"start_address",label:"出发城市"},{prop:"end_address",label:"目的城市"},{prop:"start_time",label:"开始时间"},{prop:"end_time",label:"结束时间"},{prop:"duration",label:"时长（天）"},{prop:"description",label:"备注"}],expensesField:[{prop:"start_address",label:"出发城市"},{prop:"end_address",label:"目的城市"},{prop:"start_time",label:"开始时间"},{prop:"end_time",label:"结束时间"},{prop:"traffic",label:"交通费（元）"},{prop:"stay",label:"住宿费（元）"},{prop:"diet",label:"餐饮费（元）"},{prop:"other",label:"其他费用（元）"},{prop:"description",label:"费用明细描述"}],relatedID:"",relatedCRMType:"",showRelatedDetail:!1}},computed:{relatedListData:function(){return{contacts:this.detail.contactsList||[],customer:this.detail.customerList||[],business:this.detail.businessList||[],contract:this.detail.contractList||[]}}},mounted:function(){this.getDetial()},methods:{getBaseInfo:function(){var t=this;this.loading=!0,Object(s.i)({types:"oa_examine",module:"oa",controller:"examine",action:"read",action_id:this.id,types_id:this.category_id}).then(function(e){var a=t;t.list=e.data.map(function(t,e){return a.handleShowInfo(t)}),t.loading=!1}).catch(function(){t.loading=!1})},handleShowInfo:function(t){return"date"===t.form_type&&"0000-00-00"==t.value?t.value="":"datetime"===t.form_type&&(0==t.value?t.value="":t.value=t.value?Object(d.m)(t.value,"YYYY-MM-DD HH:mm:ss"):""),t},getDetial:function(){var t=this;this.loading=!0,Object(i.e)({id:this.id}).then(function(e){t.loading=!1,t.category_id=e.data.category_id,t.getBaseInfo(),t.detail=e.data,t.category_name=t.detail.category_name,t.fileList=t.detail.fileList,t.imgList=t.detail.imgList,t.travelList=t.detail.travelList}).catch(function(){t.loading=!1})},fieldFormatter:function(t,e){return 3!=this.category_id||"start_time"!=e.property&&"end_time"!=e.property?5!=this.category_id||"start_time"!=e.property&&"end_time"!=e.property?t[e.property]:t[e.property]?Object(d.m)(t[e.property],"YYYY-MM-DD"):"":t[e.property]?Object(d.m)(t[e.property],"YYYY-MM-DD HH:mm:ss"):""},hideView:function(){this.$emit("hide-view")},checkRelatedDetail:function(t,e){this.relatedID=e[t+"_id"],this.relatedCRMType=t,this.showRelatedDetail=!0},handleFile:function(t,e,a){if("preview"===t){if(e&&e.length>0){var i=e.map(function(t){return t.url=t.file_path,t});this.$bus.emit("preview-image-bus",{index:a,data:i})}}else"download"===t&&Object(d.a)({path:e.file_path,name:e.name})},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,a){return{url:t.file_path,name:t.name}})})},downloadFile:function(t){Object(d.a)({path:t.file_path,name:t.name})},examineHandle:function(t){this.$emit("on-examine-handle",t)}}},m=(a("pWrs"),a("KHd+")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("slide-view",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-view",attrs:{listenerIDs:["workbench-main-container"],noListenerClass:t.noListenerClass,"body-style":{padding:"10px 30px",height:"100%"}},on:{"side-close":t.hideView}},[i("flexbox",{staticStyle:{height:"100%"},attrs:{orient:"vertical"}},[i("flexbox",{staticClass:"detail-header"},[i("div",{staticClass:"header-name"},[t._v(t._s(t.category_name))]),t._v(" "),i("img",{staticClass:"header-close",attrs:{src:a("cjwK")},on:{click:t.hideView}})]),t._v(" "),i("div",{staticClass:"detail-body"},[i("flexbox",{attrs:{gutter:0,align:"stretch",wrap:"wrap"}},t._l(t.list,function(e,s){return"examine_cause"!==e.form_type&&"business_cause"!==e.form_type?i("flexbox-item",{key:s,staticClass:"b-cell",attrs:{span:.5}},["user"===e.form_type?i("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[i("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"b-cell-value"},[i("flexbox",{staticStyle:{padding:"0px 10px 10px 0px"},attrs:{gutter:0,wrap:"wrap"}},t._l(e.value,function(e,a){return i("div",{key:a},[t._v("\n                  "+t._s(e.realname)+"  \n                ")])}))],1)]):"structure"===e.form_type?i("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[i("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"b-cell-value"},[i("flexbox",{staticStyle:{padding:"0px 10px 10px 0px"},attrs:{gutter:0,wrap:"wrap"}},t._l(e.value,function(e,a){return i("div",{key:a},[t._v("\n                  "+t._s(e.name)+"  \n                ")])}))],1)]):"checkbox"===e.form_type?i("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[i("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"b-cell-value"},[i("flexbox",{staticStyle:{padding:"0px 10px 10px 0px"},attrs:{gutter:0,wrap:"wrap"}},t._l(e.value,function(e,a){return i("div",{key:a},[t._v("\n                  "+t._s(e)+"  \n                ")])}))],1)]):"file"===e.form_type?i("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[i("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"b-cell-value"},t._l(e.value,function(s,n){return i("flexbox",{key:n,staticClass:"f-item"},[i("img",{staticClass:"f-img",attrs:{src:a("6KEE")}}),t._v(" "),i("div",{staticClass:"f-name"},[t._v(t._s(s.name.length>15?s.name.substring(0,15)+"...":s.name+"("+s.size+")"))]),t._v(" "),i("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){t.handleFile("preview",e.value,n)}}},[t._v("预览")]),t._v(" "),i("el-button",{attrs:{type:"text"},nativeOn:{click:function(e){t.handleFile("download",s,n)}}},[t._v("下载")])],1)}))]):i("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[i("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"b-cell-value"},[t._v(t._s(e.value))])])],1):t._e()})),t._v(" "),t.fileList.length>0||t.imgList.length>0?i("div",{staticClass:"accessory"},[i("div",{staticClass:"upload-img-box"},t._l(t.imgList,function(e,a){return i("div",{key:a,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.imgList,a)}}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.file_path_thumb,expression:"imgItem.file_path_thumb"}],key:e.file_path_thumb})])})),t._v(" "),i("div",{staticClass:"accessory-box"},t._l(t.fileList,function(t,e){return i("file-cell",{key:e,attrs:{data:t,cellIndex:e}})}))]):t._e(),t._v(" "),t.category_id&&3==t.category_id&&t.travelList&&t.travelList.length>0?i("create-sections",{staticClass:"create-sections",attrs:{title:"行程"}},[i("el-table",{staticStyle:{"font-size":"13px"},attrs:{data:t.travelList,align:"center","header-align":"center",stripe:""}},t._l(t.travelField,function(e,a){return i("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"",prop:e.prop,formatter:t.fieldFormatter,label:e.label},scopedSlots:t._u([{key:"header",fn:function(e){return[i("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}))],1):t._e(),t._v(" "),t.category_id&&5==t.category_id&&t.travelList&&t.travelList.length>0?i("create-sections",{staticClass:"create-sections",attrs:{title:"报销"}},[i("el-table",{staticStyle:{"font-size":"13px"},attrs:{data:t.travelList,align:"center","header-align":"center",stripe:""}},[t._l(t.expensesField,function(e,a){return i("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"",prop:e.prop,formatter:t.fieldFormatter,label:e.label},scopedSlots:t._u([{key:"header",fn:function(e){return[i("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}),t._v(" "),i("el-table-column",{attrs:{label:"发票",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("flexbox",{attrs:{justify:"center"}},[i("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){t.handleFile("preview",e.row.imgList,0)}}},[t._v(t._s(e.row.imgList.length)+"张")])],1)]}}])})],2)],1):t._e(),t._v(" "),t.relatedListData.contacts.length>0||t.relatedListData.customer.length>0||t.relatedListData.business.length>0||t.relatedListData.contract.length>0?i("create-sections",{staticClass:"create-sections",attrs:{title:"关联业务"}},[i("div",{staticClass:"related-business create-sections-content"},t._l(t.relatedListData,function(e,a){return i("div",{key:a},t._l(e,function(e,s){return i("related-business-cell",{key:s,attrs:{data:e,cellIndex:s,type:a,showFoot:!1},nativeOn:{click:function(i){t.checkRelatedDetail(a,e)}}})}))}))]):t._e(),t._v(" "),i("create-sections",{staticClass:"create-sections",attrs:{title:"审核信息"}},[i("examine-info",{staticClass:"create-sections-content",attrs:{id:t.id,examineType:"oa_examine",flow_id:t.detail.flow_id},on:{"on-handle":t.examineHandle}})],1)],1)],1),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showRelatedDetail,crmType:t.relatedCRMType,id:t.relatedID},on:{"update:visible":function(e){t.showRelatedDetail=e}}})],1)},[],!1,null,"45efe7b0",null);h.options.__file="examineDetail.vue";e.a=h.exports},"8KPp":function(t,e,a){"use strict";var i=a("FyfS"),s=a.n(i),n=a("Qldq"),l=a("Iae0"),o=a("KzkL"),c=(a("7Qib"),{name:"journal-log",components:{JournalCell:l.a,CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-682f"),a.e("chunk-6f45"),a.e("chunk-a259"),a.e("chunk-1137")]).then(a.bind(null,"uMjE"))},NewDialog:function(){return a.e("chunk-4c1a").then(a.bind(null,"kFvY"))}},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showFullDetail:!1,detailCRMType:"",showNewDialog:!1,formData:{},dialogTitle:"",imgFileList:[],accessoryFileList:[],newLoading:!1}},computed:{},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){e.scrollTop+e.clientHeight==e.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(o.h)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"log"}).then(function(e){var a=!0,i=!1,n=void 0;try{for(var l,o=s()(e.data.list);!(a=(l=o.next()).done);a=!0){var c=l.value;c.dataInfo.allData={},c.dataInfo.allData.business=c.dataInfo.businessList,c.dataInfo.allData.contacts=c.dataInfo.contactsList,c.dataInfo.allData.contract=c.dataInfo.contractList,c.dataInfo.allData.customer=c.dataInfo.customerList,0!=c.dataInfo.businessList.length||0!=c.dataInfo.contactsList.length||0!=c.dataInfo.contractList.length||0!=c.dataInfo.customerList.length?c.dataInfo.allDataShow=!0:c.dataInfo.allDataShow=!1}}catch(t){i=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw n}}t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},jourecallCellHandle:function(t){var e=this;if("edit"==t.type){var a=t.data.item;if(this.showNewDialog=!0,this.dialogTitle="编辑日志",this.formData=a,this.imgFileList=[],a.imgList){var i=!0,l=!1,o=void 0;try{for(var c,r=s()(a.imgList);!(i=(c=r.next()).done);i=!0){var d=c.value;d.url=d.file_path_thumb,this.imgFileList.push(d)}}catch(t){l=!0,o=t}finally{try{!i&&r.return&&r.return()}finally{if(l)throw o}}}if(this.accessoryFileList=[],a.fileList){var u=!0,m=!1,h=void 0;try{for(var p,f=s()(a.fileList);!(u=(p=f.next()).done);u=!0){var v=p.value;v.url=v.file_path_thumb,this.accessoryFileList.push(v)}}catch(t){m=!0,h=t}finally{try{!u&&f.return&&f.return()}finally{if(m)throw h}}}this.formData.depData=a.sendStructList?a.sendStructList:[],this.formData.sentWhoList=a.sendUserList?a.sendUserList:[]}else"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.d)({log_id:t.data.item.log_id}).then(function(a){for(var i in e.$message({type:"success",message:"删除成功!"}),e.list)if(e.list[i].log_id==t.data.item.log_id){e.list.splice(i,1);break}})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"related-detail"==t.type&&(this.rowID=t.data.item.key,this.detailCRMType=t.data.type,this.showFullDetail=!0)},submitBtn:function(t,e,a,i){var l=this;this.newLoading=!0;var o=[],c=[],r=[];if(this.formData.depData){var d=!0,u=!1,m=void 0;try{for(var h,p=s()(this.formData.depData);!(d=(h=p.next()).done);d=!0){var f=h.value;r.push(f.id)}}catch(t){u=!0,m=t}finally{try{!d&&p.return&&p.return()}finally{if(u)throw m}}}var v=[];if(this.formData.sentWhoList){var g=!0,_=!1,b=void 0;try{for(var y,w=s()(this.formData.sentWhoList);!(g=(y=w.next()).done);g=!0){var C=y.value;v.push(C.id)}}catch(t){_=!0,b=t}finally{try{!g&&w.return&&w.return()}finally{if(_)throw b}}}var x=!0,D=!1,k=void 0;try{for(var L,I=s()(this.imgFileList);!(x=(L=I.next()).done);x=!0){var T=L.value;o.push(T.file_id)}}catch(t){D=!0,k=t}finally{try{!x&&I.return&&I.return()}finally{if(D)throw k}}var A=!0,R=!1,E=void 0;try{for(var M,N=s()(this.accessoryFileList);!(A=(M=N.next()).done);A=!0){var S=M.value;c.push(S.file_id)}}catch(t){R=!0,E=t}finally{try{!A&&N.return&&N.return()}finally{if(R)throw E}}var j={id:this.formData.log_id,category_id:t,content:this.formData.content,tomorrow:this.formData.tomorrow,question:this.formData.question,file:c.concat(o),send_user_ids:v,send_structure_ids:r,customer_ids:i.customer_ids,contacts_ids:i.contacts_ids,business_ids:i.business_ids,contract_ids:i.contract_ids};Object(n.e)(j).then(function(t){l.refreshList(),l.showNewDialog=!1,l.$message.success("编辑成功"),l.newLoading=!1}).catch(function(t){l.newLoading=!1,l.$message.error("编辑失败")})}}}),r=(a("VuGW"),a("KHd+")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,i){return a("journal-cell",{key:i,staticClass:"list-cell",attrs:{data:e.dataInfo},on:{"on-handle":t.jourecallCellHandle}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.showNewDialog?a("new-dialog",{attrs:{formData:t.formData,dialogTitle:t.dialogTitle,imgFileList:t.imgFileList,accessoryFileList:t.accessoryFileList,newLoading:t.newLoading},on:{close:function(e){t.showNewDialog=!1},submitBtn:t.submitBtn}}):t._e()],1)},[],!1,null,"5460ac12",null);d.options.__file="JournalLog.vue";e.a=d.exports},"8gwX":function(t,e,a){"use strict";var i=a("YrMO"),s=a("Ew9n"),n=a("F03V"),l=a("U05J"),o=a("C+sD"),c=a("8DbX"),r=a("EgJF"),d=a("4+0Q"),u={name:"product-detail",components:{SlideView:s.a,CRMDetailHead:n.a,CRMBaseInfo:l.a,RelativeFiles:o.a,RelativeHandle:c.a,CRMCreateView:r.default},mixins:[d.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"product",detailData:{},headDetails:[{title:"产品类别",value:""},{title:"产品单位",value:""},{title:"产品价格",value:""},{title:"产品编码",value:""}],tabnames:[{label:"基本信息",name:"basicinfo"},{label:"附件",name:"file"},{label:"操作记录",name:"operationlog"}],tabCurrentName:"basicinfo",isCreate:!1}},computed:{tabName:function(){return"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(i.b)({id:this.id}).then(function(e){t.loading=!1,t.detailData=e.data,t.headDetails[0].value=e.data.category_id_info,t.headDetails[1].value=e.data.unit,t.headDetails[2].value=e.data.price,t.headDetails[3].value=e.data.num}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},editSaveSuccess:function(){this.getDetial()}}},m=(a("njnu"),a("KHd+")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{listenerIDs:t.listenerIDs,noListenerIDs:t.noListenerIDs,noListenerClass:t.noListenerClass,"body-style":{padding:0,height:"100%"}},on:{"side-close":t.hideView}},[t.canShowDetail?a("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限",direction:"column",align:"stretch"}},[a("c-r-m-detail-head",{attrs:{crmType:"product",detail:t.detailData,headDetails:t.headDetails,id:t.id},on:{handle:t.detailHeadHandle,close:t.hideView}}),t._v(" "),a("div",{staticClass:"tabs"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return a("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),a("div",{staticClass:"t-loading-content"},[a("keep-alive",[a(t.tabName,{tag:"component",attrs:{crmType:"product",id:t.id}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?a("c-r-m-create-view",{attrs:{"crm-type":"product",action:{type:"update",id:this.id}},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"3f2f4e96",null);h.options.__file="ProductDetail.vue";e.a=h.exports},"9HXj":function(t,e,a){},"9ZUK":function(t,e,a){},AMVD:function(t,e,a){},AWHz:function(t,e,a){"use strict";var i=a("wWfP");a.n(i).a},BMif:function(t,e,a){"use strict";var i=a("mNQR");a.n(i).a},BuGm:function(t,e,a){"use strict";a.r(e);var i=a("gDS+"),s=a.n(i),n=a("FyfS"),l=a.n(n),o=a("Dh/N"),c=(a("KTTK"),a("1RnH")),r=a("0hym"),d=a("7Qib"),u={components:{relatedBusiness:c.a,XhUser:r.a},data:function(){return{zIndex:Object(d.g)(),formList:[{label:"主题",field:"title",type:"color"},{label:"开始时间",field:"start_time",type:"time"},{label:"结束时间",field:"end_time",type:"time"},{label:"参与人",field:"owner_user_ids",type:"participant"},{label:"备注",field:"remark",type:"textarea",width:"100%"}],options:[{value:0,label:"无"},{value:1,label:"准时提醒"},{value:2,label:"5分钟前"},{value:3,label:"15分钟前"},{value:4,label:"30分钟前"},{value:5,label:"一个小时前"},{value:6,label:"二个小时前"},{value:7,label:"一天前"},{value:8,label:"二天前"},{value:9,label:"一周前"}],fileList:[],loading:!1,colorList:["#3E8EF7","#11C06C","#0BB2D4","#EB6709","#FF4C52","#526069","#9262F4"],rules:{title:[{required:!0,message:"主题不能为空",trigger:"blur"},{max:50,message:"主题长度最多为50个字符",trigger:"blur"}],start_time:[{required:!0,message:"开始时间不能为空",trigger:"blur"}],end_time:[{required:!0,message:"结束时间不能为空",trigger:"blur"}]},relevanceAll:{},allData:{},colleaguesList:[]}},props:{formData:{type:Object,default:function(){return{color:""}}},text:{type:String,default:"创建日程"},appendToBody:{type:Boolean,default:!1}},created:function(){},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.allData.business=this.formData.businessList?this.formData.businessList:[],this.allData.contacts=this.formData.contactsList?this.formData.contactsList:[],this.allData.contract=this.formData.contractList?this.formData.contractList:[],this.allData.customer=this.formData.customerList?this.formData.customerList:[],this.formData.ownerList&&(this.colleaguesList=[].concat(this.formData.ownerList)),"创建日程"==this.text&&this.$set(this.formData,"color","#3E8EF7")},methods:{close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("closeDialog")},checkInfos:function(t){this.relevanceAll=t},onSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0;var a=t.formData,i=[],n=!0,c=!1,r=void 0;try{for(var d,u=l()(t.colleaguesList);!(n=(d=u.next()).done);n=!0){var m=d.value;i.push(m.id)}}catch(t){c=!0,r=t}finally{try{!n&&u.return&&u.return()}finally{if(c)throw r}}if("创建日程"==t.text)Object(o.a)({title:a.title,start_time:new Date(a.start_time).getTime()/1e3,end_time:new Date(a.end_time).getTime()/1e3,owner_user_ids:i,remark:a.remark,color:a.color,customer_ids:t.relevanceAll.customer_ids,contacts_ids:t.relevanceAll.contacts_ids,business_ids:t.relevanceAll.business_ids,contract_ids:t.relevanceAll.contract_ids}).then(function(e){1==t.$route.query.routerKey?t.$router.push("schedule"):t.$emit("onSubmit"),t.loading=!1}).catch(function(e){t.loading=!1});else{var h={customer_ids:[],contract_ids:[],contacts_ids:[],business_ids:[]};if(t.allData.customer){var p=!0,f=!1,v=void 0;try{for(var g,_=l()(t.allData.customer);!(p=(g=_.next()).done);p=!0){var b=g.value;h.customer_ids.push(b.customer_id)}}catch(t){f=!0,v=t}finally{try{!p&&_.return&&_.return()}finally{if(f)throw v}}}if(t.allData.contract){var y=!0,w=!1,C=void 0;try{for(var x,D=l()(t.allData.contract);!(y=(x=D.next()).done);y=!0){var k=x.value;h.contract_ids.push(k.contract_id)}}catch(t){w=!0,C=t}finally{try{!y&&D.return&&D.return()}finally{if(w)throw C}}}if(t.allData.contacts){var L=!0,I=!1,T=void 0;try{for(var A,R=l()(t.allData.contacts);!(L=(A=R.next()).done);L=!0){var E=A.value;h.contacts_ids.push(E.contacts_id)}}catch(t){I=!0,T=t}finally{try{!L&&R.return&&R.return()}finally{if(I)throw T}}}if(t.allData.business){var M=!0,N=!1,S=void 0;try{for(var j,O=l()(t.allData.business);!(M=(j=O.next()).done);M=!0){var F=j.value;h.business_ids.push(F.business_id)}}catch(t){N=!0,S=t}finally{try{!M&&O.return&&O.return()}finally{if(N)throw S}}}var Y="{}"==s()(t.relevanceAll)?h:t.relevanceAll;Object(o.c)({event_id:a.event_id,title:a.title,start_time:new Date(a.start_time).getTime()/1e3,end_time:new Date(a.end_time).getTime()/1e3,owner_user_ids:i,remark:a.remark,color:a.color,customer_ids:Y.customer_ids,contacts_ids:Y.contacts_ids,business_ids:Y.business_ids,contract_ids:Y.contract_ids}).then(function(e){t.$emit("onSubmit"),t.loading=!1}).catch(function(e){t.loading=!1})}})},httpRequest:function(t){this.fileList.push(t.file)},onRemove:function(t){for(var e in this.fileList)this.fileList[e].uid==t.uid&&this.fileList.splice(e,1)},changeColor:function(t){this.$set(this.formData,"color",t)},changeCheckout:function(t){this.colleaguesList=t.data},selectDelect:function(t,e){this.$refs.xhuser[0].cancelCheckItem(t),this.colleaguesList.splice(e,1)}},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},m=(a("+3hb"),a("KHd+")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create-schedule",style:{"z-index":t.zIndex}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"add-schedule"},[i("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[i("span",{staticClass:"text"},[t._v(t._s(t.text))]),t._v(" "),i("img",{staticClass:"el-icon-close rt",attrs:{src:a("cjwK"),alt:""},on:{click:t.close}})]),t._v(" "),i("div",{staticClass:"content"},[i("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules}},t._l(t.formList,function(e,a){return i("el-form-item",{key:a,class:"el-form-item-"+e.field,style:{width:e.width},attrs:{prop:e.field,label:e.label}},["time"==e.type?[i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})]:"textarea"==e.type?[i("el-input",{attrs:{type:"textarea",autosize:{minRows:6},placeholder:"请输入内容"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})]:"participant"==e.type?[i("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[i("xh-user",{ref:"xhuser",refInFor:!0,attrs:{selectedData:t.colleaguesList},on:{changeCheckout:t.changeCheckout}}),t._v(" "),i("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[t._l(t.colleaguesList,function(e,a){return i("span",{key:a,staticClass:"select-box-span"},[t._v("\n                  "+t._s(e.realname)+"\n                  "),i("span",{staticClass:"el-icon-close",on:{click:function(i){i.stopPropagation(),t.selectDelect(e,a)}}})])}),t._v(" "),i("span",{staticClass:"el-icon-plus"})],2)],1)]:"select"==e.type?[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},t._l(t.options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))]:"color"==e.type?[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},[i("i",{staticClass:"el-input__icon",attrs:{slot:"prefix"},slot:"prefix"},[i("span",{staticClass:"bg-color",style:{background:t.formData.color}})])]),t._v(" "),i("div",{staticClass:"color-box"},t._l(t.colorList,function(e,a){return i("span",{key:a,style:{background:e},on:{click:function(a){t.changeColor(e)}}})}))]:i("el-input",{model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})],2)})),t._v(" "),i("related-business",{attrs:{allData:t.allData},on:{checkInfos:t.checkInfos}})],1),t._v(" "),i("div",{staticClass:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),t._v(" "),i("el-button",{on:{click:t.close}},[t._v("取消")])],1)])])},[],!1,null,"7a8dcccc",null);h.options.__file="createSchedule.vue";e.default=h.exports},DUlf:function(t,e,a){"use strict";var i=a("KzkL"),s=a("mX3o"),n={name:"relative-team",components:{TeamsHandle:a("eOzp").a},computed:{},mixins:[s.a],data:function(){return{list:[],fieldList:[],tableHeight:"400px",teamsDialogShow:!1,handleType:1,editPermissionShow:!1,selectionList:[]}},watch:{id:function(t){this.list=[],this.getDetail()}},props:{id:[String,Number],detail:{type:Object,default:function(){return{}}},crmType:{type:String,default:""}},mounted:function(){this.fieldList.push({prop:"realname",width:"200",label:"姓名"}),this.fieldList.push({prop:"structure_name",width:"200",label:"职位"}),this.fieldList.push({prop:"group_name",width:"200",label:"团队角色"}),this.fieldList.push({prop:"authority",width:"200",label:"权限"}),this.getDetail()},activated:function(){},deactivated:function(){},methods:{getDetail:function(){var t=this;this.loading=!0,Object(i.p)({types:"crm_"+this.crmType,types_id:this.id}).then(function(e){t.loading=!1,t.list=e.data}).catch(function(){t.loading=!1})},handleSelectionChange:function(t){this.selectionList=t},handleClick:function(t){var e=this;"add"==t?this.teamsDialogShow=!0:0==this.selectionList.length?this.$message.error("请勾选需要操作的团队成员"):"edit"==t?this.editPermissionShow=!0:"remove"==t&&this.$confirm("此操作将移除这些团队成员是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.selectionList.map(function(t,e,a){return t.id}),a={types:"crm_"+e.crmType,types_id:[e.detail[e.crmType+"_id"]],user_id:t,is_del:1};e.loading=!0,Object(i.q)(a).then(function(t){e.$message({type:"success",message:t.data}),e.loading=!1,e.getDetail()}).catch(function(){e.loading=!1})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleCallBack:function(t){this.getDetail()},handleEditConfirm:function(){var t=this,e=this.selectionList.map(function(t,e,a){return t.id});this.loading=!0,Object(i.q)({types:"crm_"+this.crmType,types_id:[this.detail[this.crmType+"_id"]],user_id:e,type:this.handleType}).then(function(e){t.editPermissionShow=!1,t.$message({type:"success",message:e.data}),t.loading=!1,t.getDetail()}).catch(function(){t.loading=!1})},handleSelectable:function(t,e){return 0!=t.type},handleRowClick:function(t,e,a){},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}}}},l=(a("ze4I"),a("KHd+")),o=Object(l.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rc-cont"},[a("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("remove")}}},[t._v("移除")]),t._v(" "),a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("edit")}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("add")}}},[t._v("添加团队成员")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,stripe:"","header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle},on:{"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55",selectable:t.handleSelectable}}),t._v(" "),t._l(t.fieldList,function(t,e){return a("el-table-column",{key:e,attrs:{"show-overflow-tooltip":"",prop:t.prop,label:t.label}})})],2),t._v(" "),a("teams-handle",{attrs:{crmType:t.crmType,title:"添加团队成员",selectionList:[t.detail],dialogVisible:t.teamsDialogShow},on:{handle:t.handleCallBack,"update:dialogVisible":function(e){t.teamsDialogShow=e}}}),t._v(" "),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{title:"编辑权限",visible:t.editPermissionShow,"append-to-body":!0,width:"400px"},on:{"update:visible":function(e){t.editPermissionShow=e}}},[a("div",{staticClass:"handle-box"},[a("flexbox",{staticClass:"handle-item"},[a("div",{staticClass:"handle-item-name"},[t._v("权限：")]),t._v(" "),a("el-radio-group",{model:{value:t.handleType,callback:function(e){t.handleType=e},expression:"handleType"}},[a("el-radio",{attrs:{label:1}},[t._v("只读")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("读写")])],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.editPermissionShow=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.handleEditConfirm(e)}}},[t._v("保存")])],1)])],1)},[],!1,null,"47b4155a",null);o.options.__file="RelativeTeam.vue";e.a=o.exports},"Dh/N":function(t,e,a){"use strict";a.d(e,"d",function(){return s}),a.d(e,"a",function(){return n}),a.d(e,"b",function(){return l}),a.d(e,"c",function(){return o});var i=a("t3Un");function s(t){return Object(i.a)({url:"oa/event/index",method:"post",data:t})}function n(t){return Object(i.a)({url:"oa/event/save",method:"post",data:t})}function l(t){return Object(i.a)({url:"oa/event/delete",method:"post",data:t})}function o(t){return Object(i.a)({url:"oa/event/update",method:"post",data:t})}},FFAi:function(t,e,a){},FFF9:function(t,e,a){"use strict";var i=a("gs4d");a.n(i).a},FJ55:function(t,e,a){"use strict";var i=a("qnaT");a.n(i).a},Fpl1:function(t,e,a){"use strict";var i=a("Er7M"),s=a("O1Uw"),n={name:"examine-cell",components:{RelatedBusinessCell:i.a,FileCell:s.a},mixins:[],computed:{relatedListData:function(){return{contacts:this.data.contactsList||[],customer:this.data.customerList||[],business:this.data.businessList||[],contract:this.data.contractList||[]}}},watch:{},data:function(){return{}},props:{data:Object},mounted:function(){},methods:{getStatusName:function(t){return 0==t?"待审":1==t?"审批中":2==t?"通过":3==t?"拒绝":4==t?"撤回":""},getStatusColor:function(t){return 0==t?"#F3A633":1==t?"#F3A633":2==t?"#93E06D":3==t?"#FF0000":4==t?"#FF0000":""},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,a){return{url:t.file_path,name:t.name}})})},downloadFile:function(t){},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})},checkDetail:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data}})},checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})}}},l=(a("UxBq"),a("KHd+")),o=Object(l.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("div",{staticClass:"list-content"},[a("flexbox",{staticClass:"header"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.create_user_info,expression:"data.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(data.create_user_info.thumb_img)",arg:"background-image"}],staticClass:"div-photo head-img"}),t._v(" "),a("div",{staticClass:"name-time"},[a("span",{staticClass:"name"},[t._v(t._s(t.data.create_user_info.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(t._f("filterTimestampToFormatTime")(t.data.create_time)))])]),t._v(" "),a("div",{staticClass:"rt-setting"},[a("span",{staticClass:"bg-color",style:{"background-color":t.getStatusColor(t.data.check_status)}}),t._v(" "),a("span",{staticClass:"dep"},[a("span",[t._v(t._s(t.data.category_name)+" - ")]),t._v(" "),a("span",[t._v(t._s(t.getStatusName(t.data.check_status)))])]),t._v(" "),t.data.permission&&(t.data.permission.is_recheck||t.data.permission.is_update||t.data.permission.is_delete)?a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission&&t.data.permission.is_recheck?a("el-dropdown-item",{attrs:{command:"withdraw"}},[t._v("撤回")]):t._e(),t._v(" "),t.data.permission&&t.data.permission.is_update?a("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]):t._e(),t._v(" "),t.data.permission&&t.data.permission.is_delete?a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")]):t._e()],1)],1):t._e()],1)]),t._v(" "),a("div",{staticClass:"row",on:{click:function(e){t.checkDetail(t.data)}}},[t.data.content?a("p",{staticClass:"text"},[t._v(t._s(t.data.content))]):t._e(),t._v(" "),t.data.causeTitle?a("p",{staticClass:"title"},[t._v(t._s(t.data.causeTitle))]):t._e()]),t._v(" "),t.data.fileList.length>0||t.data.imgList.length>0?a("div",{staticClass:"accessory"},[a("div",{staticClass:"upload-img-box"},t._l(t.data.imgList,function(e,i){return a("div",{key:i,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.data.imgList,i)}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.file_path_thumb,expression:"imgItem.file_path_thumb"}]})])})),t._v(" "),a("div",{staticClass:"accessory-box"},t._l(t.data.fileList,function(t,e){return a("file-cell",{key:e,attrs:{data:t,cellIndex:e}})}))]):t._e(),t._v(" "),t.relatedListData.contacts.length>0||t.relatedListData.customer.length>0||t.relatedListData.business.length>0||t.relatedListData.contract.length>0?a("div",{staticClass:"related-business"},[a("div",{staticClass:"label"},[t._v("关联业务")]),t._v(" "),t._l(t.relatedListData,function(e,i){return a("div",{key:i},t._l(e,function(e,s){return a("related-business-cell",{key:s,attrs:{data:e,cellIndex:s,type:i,showFoot:!1},nativeOn:{click:function(a){t.checkRelatedDetail(i,e)}}})}))})],2):t._e()],1)])},[],!1,null,"093dec13",null);o.options.__file="examineCell.vue";e.a=o.exports},H5CR:function(t,e,a){"use strict";var i=a("0djP");a.n(i).a},"HF+F":function(t,e,a){},Iae0:function(t,e,a){"use strict";var i=a("QbLZ"),s=a.n(i),n=a("S3Kq"),l=a("Qldq"),o=a("1RnH"),c=a("L2JU"),r=a("O1Uw"),d={name:"journal-cell",components:{emoji:n.a,relatedBusiness:o.a,FileCell:r.a},mixins:[],computed:s()({},Object(c.b)(["userInfo"])),watch:{},data:function(){return{commentsTextarea:"",childCommentsTextarea:"",commentsPopover:!1,replyChildComment:null,replyChildIndex:-1,childCommentsPopover:!1,blurIndex:0,contentLoading:!1,parentTarget:null,awaitMoment:!1}},props:{data:Object,logIndex:{type:Number,default:0},showWorkbench:{type:Boolean,default:!1}},mounted:function(){var t=this;0!=this.data.is_read||this.showWorkbench||this.$bus.on("journal-list-box-scroll",function(e){if(0==t.data.is_read){e&&(t.parentTarget=e);var a=t.whetherPreview();!t.awaitMoment&&a&&(t.awaitMoment=!0,setTimeout(function(){t.awaitMoment=!1,t.whetherPreview()&&t.submiteIsRead()},3e3))}})},methods:{whetherPreview:function(){var t=this.parentTarget.children[this.logIndex];if(this.parentTarget.getBoundingClientRect()){var e=this.parentTarget.getBoundingClientRect().top-t.getBoundingClientRect().top,a=!1;return e<=0&&Math.abs(e)<this.parentTarget.clientHeight?a=!0:e>0&&e<t.clientHeight&&(a=!0),a}return!1},submiteIsRead:function(){var t=this;Object(l.g)({log_id:this.showWorkbench?this.data.action_id:this.data.log_id}).then(function(e){t.data.is_read=1}).catch(function(t){})},verifyAwaitInfo:function(){},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})},checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})},discussDelete:function(t,e,a){var i=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.b)({comment_id:t.comment_id,log_id:t.type_id}).then(function(t){i.$message({type:"success",message:"删除成功!"}),e.splice(a,1),i.$emit("on-handle",{type:"discuss-delete",data:{item:i.data}})})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},discussBtn:function(t,e){t.show?(this.$set(t,"show",!1),this.replyChildComment=null):(this.$set(t,"show",!0),this.$set(t,"showComment",!1),this.replyChildComment=t,this.replyChildIndex=e)},childCommentSubmit:function(){var t=this;if(this.replyChildComment&&this.childCommentsTextarea){var e=-1==this.replyChildIndex?this.replyChildComment:this.replyChildComment.replyList[this.replyChildIndex];this.contentLoading=!0,Object(l.c)({reply_fid:this.replyChildComment.comment_id,log_id:e.type_id,content:this.childCommentsTextarea,reply_content:e.content,reply_comment_id:e.comment_id,reply_user_id:e.userInfo.id,reply_name:e.userInfo.realname}).then(function(a){t.replyChildComment.replyList.push({comment_id:a.data,type_id:e.type_id,userInfo:t.userInfo,create_time:parseInt((new Date).getTime()/1e3),content:t.childCommentsTextarea,reply_content:e.content,replyuserInfo:e.userInfo}),t.$message.success("回复成功"),t.replyChildComment.show=!1,t.replyChildComment=null,t.contentLoading=!1,t.childCommentsTextarea="",t.$emit("on-handle",{type:"discuss-submit",data:{item:t.data}})}).catch(function(e){t.$message.error("回复失败"),t.contentLoading=!1})}},commentSubmit:function(t){var e=this;this.commentsTextarea&&(this.contentLoading=!0,Object(l.c)({log_id:this.showWorkbench?this.data.action_id:this.data.log_id,content:this.commentsTextarea}).then(function(a){t.showComment=!1,t.replyList.push({comment_id:a.data,type_id:e.showWorkbench?e.data.action_id:e.data.log_id,userInfo:e.userInfo,create_time:parseInt((new Date).getTime()/1e3),content:e.commentsTextarea,replyList:[],show:!1}),e.commentsTextarea="",e.$message.success("回复成功"),e.contentLoading=!1}).catch(function(t){e.$message.error("回复失败"),e.contentLoading=!1}))},commentBtn:function(t){t.showComment?this.$set(t,"showComment",!1):(this.replyChildComment&&(this.replyChildComment.show=!1),this.$set(t,"showComment",!0))},selectEmoji:function(t){var e=this.commentsTextarea.split("");e.splice(this.blurIndex,0,t),this.commentsTextarea=e.join(""),this.commentsPopover=!1},childSelectEmoji:function(t){var e=this.childCommentsTextarea.split("");e.splice(this.blurIndex,0,t),this.childCommentsTextarea=e.join(""),this.childCommentsPopover=!1},blurFun:function(t){this.blurIndex=t.target.selectionEnd},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,a){return{url:t.file_path,name:t.name}})})}},beforeDestroy:function(){this.$bus.off("journal-list-box-scroll")}},u=(a("18jM"),a("KHd+")),m=Object(u.a)(d,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"list",attrs:{id:"journal-cell"+t.logIndex}},[i("div",{staticClass:"list-content"},[i("div",{staticClass:"header"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.create_user_info,expression:"data.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(data.create_user_info.thumb_img)",arg:"background-image"}],key:t.data.create_user_info.thumb_img,staticClass:"div-photo head-img header-circle"}),t._v(" "),i("div",{staticClass:"row"},[i("p",{staticClass:"row-title"},[i("span",{staticClass:"name"},[t._v(t._s(t.data.create_user_info.realname))]),t._v(" "),t.showWorkbench?i("span",{staticClass:"item-content"},[t._v(t._s(t.data.action_content))]):i("span",{staticClass:"read",style:{color:0==t.data.is_read?"#3E84E9":"#ccc"}},[t._v(t._s(0==t.data.is_read?"未读":"已读"))])]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s(t._f("moment")(t.data.create_time,"YYYY-MM-DD HH:mm")))]),t._v(" "),i("el-tooltip",{attrs:{disabled:!(t.data.sendUserList.length>0||t.data.sendStructList.length>0),placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",{staticClass:"members-dep-title"},[t.data.sendUserList?i("span",t._l(t.data.sendUserList,function(e,a){return i("span",{key:a},[t._v("\n                  "+t._s(0==t.data.sendStructList.length&&a==t.data.sendUserList.length-1?e.realname:e.realname+"，")+"\n                ")])})):t._e(),t._v(" "),t._l(t.data.sendStructList,function(e,a){return 0!=t.data.sendStructList.legnth?i("span",{key:a},[t._v("\n                "+t._s(a==t.data.sendStructList.length-1?e.name:e.name+"，")+"\n              ")]):t._e()})],2)]),t._v(" "),i("p",{staticClass:"row-title",staticStyle:{display:"inline-block"}},[t.data.sendStructList?i("span",[t._v(t._s(t.data.sendStructList.length)+" 个部门，")]):t._e(),t._v(" "),t.data.sendUserList?i("span",[t._v(t._s(t.data.sendUserList.length)+"个同事")]):t._e()])])],1),t._v(" "),t.showWorkbench?t._e():i("div",{staticClass:"rt-setting"},[i("span",{staticClass:"dep"},[t._v(t._s(t.data.range))]),t._v(" "),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]),t._v(" "),i("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")])],1)],1)],1)]),t._v(" "),i("div",{staticClass:"text"},[t.data.content?i("p",{staticClass:"row"},[i("span",{staticClass:"title"},[t._v(t._s(1==t.data.category_id?"今日工作内容":2==t.data.category_id?"本周工作内容":"本月工作内容")+"：")]),t._v("\n        "+t._s(t.data.content)+"\n      ")]):t._e(),t._v(" "),t.data.tomorrow?i("p",{staticClass:"row"},[i("span",{staticClass:"title"},[t._v(t._s(1==t.data.category_id?"明日工作内容":2==t.data.category_id?"下周工作内容":"下月工作内容")+"：")]),t._v("\n        "+t._s(t.data.tomorrow)+"\n      ")]):t._e(),t._v(" "),t.data.question?i("p",{staticClass:"row"},[i("span",{staticClass:"title"},[t._v("遇到的问题：")]),t._v("\n        "+t._s(t.data.question)+"\n      ")]):t._e()]),t._v(" "),i("div",{staticClass:"accessory"},[0!=t.data.imgList.length?i("div",{staticClass:"upload-img-box"},t._l(t.data.imgList,function(e,a){return i("div",{key:a,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.data.imgList,a)}}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.file_path,expression:"imgItem.file_path"}],key:e.file_path})])})):t._e(),t._v(" "),0!=t.data.fileList.length?i("div",{staticClass:"accessory-box"},t._l(t.data.fileList,function(t,e){return i("file-cell",{key:e,attrs:{data:t,cellIndex:e}})})):t._e()]),t._v(" "),t.data.allDataShow?i("related-business",{attrs:{marginLeft:"0",alterable:!1,allData:t.data.allData},on:{checkRelatedDetail:t.checkRelatedDetail}}):t._e(),t._v(" "),0!=t.data.replyList.length?i("div",{staticClass:"discuss"},[i("div",{staticClass:"border"}),t._v(" "),t._l(t.data.replyList,function(e,s){return i("div",{key:s,staticClass:"discuss-list"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:e.userInfo,expression:"discussItem.userInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.userInfo.thumb_img),expression:"$options.filters.filterUserLazyImg(discussItem.userInfo.thumb_img)",arg:"background-image"}],staticClass:"div-photo head-img header-circle"}),t._v(" "),i("span",{staticClass:"name"},[t._v(t._s(e.userInfo.realname))]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s(t._f("moment")(e.create_time,"YYYY-MM-DD HH:mm")))]),t._v(" "),i("div",{staticClass:"rt"},[i("span",{on:{click:function(a){t.discussDelete(e,t.data.replyList,s)}}},[t._v("删除")]),t._v(" "),i("span",{on:{click:function(a){t.discussBtn(e,-1)}}},[t._v("回复")])]),t._v(" "),i("p",{staticClass:"reply-title"},[i("span",{domProps:{innerHTML:t._s(t.emoji(e.content))}})]),t._v(" "),i("p",{staticClass:"discuss-content",domProps:{innerHTML:t._s(t.emoji(e.reply_content))}}),t._v(" "),e.replyList&&e.replyList.length>0?i("div",{staticClass:"children-reply"},t._l(e.replyList,function(a,s){return i("div",{key:s,staticClass:"discuss-list"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:a.userInfo,expression:"childDiscussItem.userInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(a.userInfo.thumb_img),expression:"$options.filters.filterUserLazyImg(childDiscussItem.userInfo.thumb_img)",arg:"background-image"}],staticClass:"div-photo head-img header-circle"}),t._v(" "),i("span",{staticClass:"name"},[t._v(t._s(a.userInfo.realname))]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s(t._f("moment")(a.create_time,"YYYY-MM-DD HH:mm")))]),t._v(" "),i("div",{staticClass:"rt"},[i("span",{on:{click:function(i){t.discussDelete(a,e.replyList,s)}}},[t._v("删除")]),t._v(" "),i("span",{on:{click:function(a){t.discussBtn(e,s)}}},[t._v("回复")])]),t._v(" "),i("p",{staticClass:"reply-title"},[[i("span",[t._v("回复")]),t._v(" "),i("span",{staticClass:"reply"},[t._v("@"+t._s(a.replyuserInfo.realname)+"：")])],t._v(" "),i("span",{domProps:{innerHTML:t._s(t.emoji(a.content))}})],2)])})):t._e(),t._v(" "),e.show?i("div",{staticClass:"comment-box"},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},on:{blur:t.blurFun},model:{value:t.childCommentsTextarea,callback:function(e){t.childCommentsTextarea=e},expression:"childCommentsTextarea"}}),t._v(" "),i("div",{staticClass:"btn-group"},[i("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.childCommentsPopover,callback:function(e){t.childCommentsPopover=e},expression:"childCommentsPopover"}},[i("emoji",{on:{select:t.childSelectEmoji}}),t._v(" "),i("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:a("woiz")},slot:"reference"})],1),t._v(" "),i("div",{staticClass:"btn-box"},[i("el-button",{attrs:{type:"primary",loading:t.contentLoading},on:{click:function(e){t.childCommentSubmit()}}},[t._v("回复")]),t._v(" "),i("el-button",{on:{click:function(t){e.show=!1}}},[t._v("取消")])],1)],1)],1):t._e(),t._v(" "),i("div",{staticClass:"border"})])})],2):t._e()],1),t._v(" "),i("div",{staticClass:"footer"},[i("span",{staticClass:"comment",on:{click:function(e){t.commentBtn(t.data)}}},[t._v("回复")])]),t._v(" "),t.data.showComment?i("div",{staticClass:"comment-box"},[i("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},on:{blur:t.blurFun},model:{value:t.commentsTextarea,callback:function(e){t.commentsTextarea=e},expression:"commentsTextarea"}}),t._v(" "),i("div",{staticClass:"btn-group"},[i("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.commentsPopover,callback:function(e){t.commentsPopover=e},expression:"commentsPopover"}},[i("emoji",{on:{select:t.selectEmoji}}),t._v(" "),i("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:a("woiz")},slot:"reference"})],1),t._v(" "),i("div",{staticClass:"btn-box"},[i("el-button",{attrs:{type:"primary",loading:t.contentLoading},on:{click:function(e){t.commentSubmit(t.data)}}},[t._v("回复")]),t._v(" "),i("el-button",{on:{click:function(e){t.data.showComment=!1}}},[t._v("取消")])],1)],1)],1):t._e()])},[],!1,null,"3669fce8",null);m.options.__file="journalCell.vue";e.a=m.exports},K6D0:function(t,e,a){"use strict";var i=a("ooHJ"),s=a("Ew9n"),n=a("F03V"),l=a("U05J"),o=a("8DbX"),c=a("EgJF"),r=a("3biH"),d=(a("7Qib"),a("4+0Q")),u={name:"money-detail",components:{SlideView:s.a,CRMDetailHead:n.a,CRMBaseInfo:l.a,RelativeHandle:o.a,ExamineInfo:r.a,CRMCreateView:c.default},mixins:[d.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"receivables",detailData:{},headDetails:[{title:"客户名称",value:""},{title:"合同金额",value:""},{title:"合同名称",value:""},{title:"回款日期",value:""},{title:"回款金额",value:""},{title:"负责人",value:""}],tabnames:[{label:"基本信息",name:"basicinfo"},{label:"操作记录",name:"operationlog"}],tabCurrentName:"basicinfo",isCreate:!1}},computed:{tabName:function(){return"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"operationlog"==this.tabCurrentName?"relative-handle":""}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(i.e)({id:this.id}).then(function(e){t.loading=!1,t.detailData=e.data,t.headDetails[0].value=e.data.customer_id_info?e.data.customer_id_info.name:"",t.headDetails[1].value=e.data.contract_id_info?e.data.contract_id_info.money:"",t.headDetails[2].value=e.data.contract_id_info?e.data.contract_id_info.name:"",t.headDetails[3].value="0000-00-00"==e.data.return_time?"":e.data.return_time,t.headDetails[4].value=e.data.money,t.headDetails[5].value=e.data.owner_user_id_info?e.data.owner_user_id_info.realname:""}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},editSaveSuccess:function(){this.getDetial()}}},m=(a("XCNI"),a("KHd+")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{listenerIDs:t.listenerIDs,noListenerIDs:t.noListenerIDs,noListenerClass:t.noListenerClass,"body-style":{padding:0,height:"100%"}},on:{"side-close":t.hideView}},[t.canShowDetail?a("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限",direction:"column",align:"stretch"}},[a("c-r-m-detail-head",{attrs:{crmType:"receivables",detail:t.detailData,headDetails:t.headDetails,id:t.id},on:{handle:t.detailHeadHandle,close:t.hideView}}),t._v(" "),a("div",{staticClass:"examine-info"},[a("examine-info",{staticClass:"examine-info-border",attrs:{id:t.id,examineType:"crm_receivables",flow_id:t.detailData.flow_id}})],1),t._v(" "),a("div",{staticClass:"tabs"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return a("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),a("div",{staticClass:"t-loading-content"},[a("keep-alive",[a(t.tabName,{tag:"component",attrs:{crmType:"receivables",detail:t.detailData,id:t.id}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?a("c-r-m-create-view",{attrs:{"crm-type":"receivables",action:{type:"update",id:this.id}},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"271ce2ae",null);h.options.__file="MoneyDetail.vue";e.a=h.exports},N0PQ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZGRjBCRTYxRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZGRjBCRTYyRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkZGMEJFNUZFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkZGMEJFNjBFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz704RrgAAABwUlEQVR42uSXz0sCQRTH36h1sGNlaHjpVJoHC0KCOnVJOwSdqmM/6NZ/EF071rluQaduGQWd9BZEqWBhQQQmHYIQikDU6bs6G8Oy4q7sskYPPuzOzFu+++a9mZ1lnHNywlzkkDkm7JEb7/m8rWIDoVBHEc+DEuAaSmLMtqk+An6dfr8Ys0T4BHxJUbUzJq6q/yc47kR4CXg1fevgTcf3Faxp+vrAsuHikqxH054A5y2mWvYxnEaPwZTc/Kl1zJPJBt27gbR667YlnUjYMNWMORMxi8edETZhH+AZ9IIx4LZb+A5sieskGALfYMWW4hIFdQtmwJyIVt5gruEziucfrF5OVbAKZsGpzq42BVIQH+6suFovlRRQojnTzWethl73IO52wYaVEd+DcTDSaFUqRPV6c6RYJJ5ON8WJFqwuLkWl/7cWMhmE4SLm8xHP5YhFIkrEJPsYibhqQDgKCur3moXDROUy8Wy2KRoMqn5PZoQLBoSnxTf7otHyeonFYsSiUVlUsUMzwttAOfnV2my3e2ATvKjiFAjIPpdg30yOr0DYRL6VpbMDFoEPPIpz2EGrl2fyn0S3Hm8tNfbv/p1+BBgA+Vdv2Iz9D6cAAAAASUVORK5CYII="},NOa9:function(t,e,a){},O1Uw:function(t,e,a){"use strict";var i=a("7Qib"),s=a("KTTK"),n={name:"file-cell",computed:{},watch:{},data:function(){return{}},props:{cellIndex:Number,data:Object,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!1},module_id:[String,Number]},mounted:function(){},methods:{downloadClick:function(){Object(i.a)({path:this.data.file_path,name:this.data.name})},deleteClick:function(){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.c)({module:"work_task",module_id:t.module_id,save_name:t.data.save_name}).then(function(e){t.$message.success(e.data),t.$emit("delete",t.cellIndex,t.data)}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}},beforeDestroy:function(){}},l=(a("o4Pz"),a("KHd+")),o=Object(l.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("flexbox",{staticClass:"cell"},[i("img",{staticClass:"cell-head",attrs:{src:a("6KEE"),alt:""}}),t._v(" "),i("div",{staticClass:"cell-body",class:{"cursor-pointer":t.cursorPointer}},[i("span",[t._v(t._s(t.data.name))]),t._v(" "),i("span",{staticClass:"size"},[t._v("("+t._s(t.data.size)+")")])]),t._v(" "),i("div",{staticClass:"cell-foot"},[i("i",{staticClass:"el-icon-download",on:{click:t.downloadClick}}),t._v(" "),t.showDelete?i("i",{staticClass:"el-icon-delete",on:{click:t.deleteClick}}):t._e()])])},[],!1,null,"c5c9499e",null);o.options.__file="index.vue";e.a=o.exports},OPCT:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVENDNERTkxRTA5QjExRThBQkRDQjRERjVBMjY3MzE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVENDNERTkyRTA5QjExRThBQkRDQjRERjVBMjY3MzE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQ0M0RFOEZFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQ0M0RFOTBFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7c1/V2AAABIElEQVR42mL8//8/AwicPXuWgVxgbGwMZzMRUBsGxBeB+AXITigfL2DBIxcCxHlA7AnEz4CYB4gnQ+VW4dKEz4UNQBwNNQwEvgBxBhAn4XMhPgMFgPghmthPIP5NroF/cYgzkmsgMw7x/+Qa+AGIZbBEIgu5BjYC8VIgloLyQbE8E4gXkJtsVkMt3Ak1DOTiDiBeSa6BDFDNK0nJNdi8rArEa4H4IzQC0PFHqLwqMQaqA/ERID4IxIrQJIKOFaDyR6Dq8Xq5DYon4fHVe6g8J1RtMD4XugDxYiKDazYQu5GSbMgC6AbuAeJYIvWmAPEuQmFYDQ3w/1Cvv8dikCDU0mIgtifkwhtAbAdV+BBHsnkIlbeDqieYsG+ixxwpACDAAIZEQR7SM/O0AAAAAElFTkSuQmCC"},Op00:function(t,e,a){"use strict";var i=a("+9th"),s={name:"task-cell",components:{},mixins:[],computed:{},watch:{},data:function(){return{}},props:{data:Object,dataIndex:Number},mounted:function(){},methods:{taskOverClick:function(t){Object(i.r)({task_id:t.task_id,type:t.checked?1:2}).then(function(t){}).catch(function(e){t.checked=!1})},rowFun:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data,index:this.dataIndex}})},onmouseoverFun:function(t){this.$refs.itemSpan.offsetWidth>this.$refs.listLeft.offsetWidth-21?this.$set(t,"show",!0):this.$set(t,"show",!1)}}},n=(a("FJ55"),a("KHd+")),l=Object(n.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"taskRow",staticClass:"list",style:{"border-left-color":1==t.data.priority?"#8bb5f0":2==t.data.priority?"#FF9668":3==t.data.priority?"#ED6363":"transparent"},on:{click:function(e){t.rowFun(t.data)}}},[a("div",{ref:"listLeft",staticClass:"list-left"},[a("div",{class:t.data.checked?"title title-active":"title",on:{click:function(t){t.stopPropagation()}}},[a("el-checkbox",{on:{change:function(e){t.taskOverClick(t.data)}},model:{value:t.data.checked,callback:function(e){t.$set(t.data,"checked",e)},expression:"data.checked"}})],1),t._v(" "),a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"task-tooltip tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(t.data.task_name))])]),t._v(" "),a("span",{ref:"itemSpan",class:t.data.checked?"item-name-active":"item-name"},[t._v("\n        "+t._s(t.data.task_name)+"\n      ")])])],1),t._v(" "),a("div",{staticClass:"list-right"},[t.data.lableList?a("div",{staticClass:"tag-box"},[t.data.lableList.length<=2?t._l(t.data.lableList,function(e,i){return a("div",{key:i,staticClass:"item-label"},[a("span",{staticClass:"k-name",style:{background:e.color}},[t._v(t._s(e.name))])])}):[a("span",{staticClass:"k-name",style:{background:t.data.lableList[0].color}},[t._v(t._s(t.data.lableList[0].name))]),t._v(" "),a("span",{staticClass:"k-name",style:{background:t.data.lableList[1].color}},[t._v(t._s(t.data.lableList[1].name))]),t._v(" "),a("el-tooltip",{attrs:{placement:"top",effect:"light","popper-class":"tooltip-change-border task-tooltip"}},[a("div",{staticClass:"tooltip-content",staticStyle:{margin:"10px 10px 10px 0"},attrs:{slot:"content"},slot:"content"},t._l(t.data.lableList,function(e,i){return a("div",{key:i,staticClass:"item-label",staticStyle:{display:"inline-block","margin-right":"10px"}},[i>=2?a("span",{staticClass:"k-name",staticStyle:{"border-radius":"3px",color:"#FFF",padding:"3px 10px"},style:{background:e.color?e.color:"#ccc"}},[t._v(t._s(e.name))]):t._e()])})),t._v(" "),a("span",{staticClass:"color-label-more"},[a("i",[t._v("...")])])])]],2):t._e(),t._v(" "),a("div",{staticClass:"img-group"},[t.data.relationCount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-relevance"}),t._v(" "),a("span",[t._v(t._s(t.data.relationCount))])]):t._e(),t._v(" "),t.data.subcount+t.data.subdonecount!=0?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),a("span",[t._v(t._s(t.data.subdonecount)+"/"+t._s(t.data.subcount+t.data.subdonecount))])]):t._e(),t._v(" "),t.data.filecount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-file"}),t._v(" "),a("span",[t._v(t._s(t.data.filecount))])]):t._e(),t._v(" "),t.data.commentcount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-comment-task"}),t._v(" "),a("span",[t._v(t._s(t.data.commentcount))])]):t._e(),t._v(" "),t.data.stop_time?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-time-task",style:{color:1!=t.data.is_end||t.data.checked?"#999":"red"}}),t._v(" "),a("span",{style:{color:1!=t.data.is_end||t.data.checked?"#999":"red"}},[t._v(t._s(t._f("moment")(t.data.stop_time,"MM-DD"))+" 截止")])]):t._e()]),t._v(" "),a("div",{staticClass:"item-own-box"},[t.data.main_user&&t.data.main_user.id?a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(t.data.main_user.realname))])]),t._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.main_user,expression:"data.main_user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.main_user.thumb_img),expression:"$options.filters.filterUserLazyImg(data.main_user.thumb_img)",arg:"background-image"}],staticClass:"div-photo"})]):t._e()],1)])])},[],!1,null,"1338f056",null);l.options.__file="taskCell.vue";e.a=l.exports},PS1M:function(t,e,a){"use strict";var i=a("qbf4"),s=a("Ew9n"),n=a("F03V"),l=a("UEWd"),o=a("QJC7"),c=a("8KPp"),r=a("gd5k"),d=a("aQg/"),u=a("y9lt"),m=a("KzkL"),h=a("7Qib"),p={name:"contacts-follow",components:{MixAdd:l.a,RecordLog:o.a,JournalLog:c.a,ExamineLog:r.a,TaskLog:d.a,ScheduleLog:u.a},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{},data:function(){return{sendLoading:!1,followTypes:[{type:"打电话",name:"打电话"},{type:"发邮件",name:"发邮件"},{type:"发短信",name:"发短信"},{type:"见面拜访",name:"见面拜访"},{type:"活动",name:"活动"}],followType:"打电话",next_time:"",is_event:!1,logType:"record",logTypes:[{type:"record",name:"跟进记录"},{type:"log",name:"日志"},{type:"examine",name:"审批"},{type:"task",name:"任务"},{type:"schedule",name:"日程"}]}},computed:{componentsName:function(){return"record"==this.logType?"RecordLog":"log"==this.logType?"JournalLog":"examine"==this.logType?"ExamineLog":"task"==this.logType?"TaskLog":"schedule"==this.logType?"ScheduleLog":""}},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(t){this.followType=t},logTabsClick:function(t,e){this.logType=t.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(t){var e=this;if(!this.is_event||this.next_time){var a={};a.types="crm_"+this.crmType,a.types_id=this.id,a.content=t.content,a.category=this.followType;var i=t.images.map(function(t,e,a){return t.file_id}),s=t.files.map(function(t,e,a){return t.file_id});a.file_id=i.concat(s),this.next_time&&(a.is_event=this.is_event?1:0,a.next_time=Object(h.d)(this.next_time)),this.sendLoading=!0,Object(m.i)(a).then(function(t){e.sendLoading=!1,e.$message.success(t.data),e.$refs.mixadd.resetInfo(),e.is_event=!1,e.next_time="",e.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){e.sendLoading=!1})}else this.$message.error("请选择下次联系时间")}}},f=(a("z4Pn"),a("KHd+")),v=Object(f.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"f-container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sendLoading,expression:"sendLoading"}]},[a("mix-add",{ref:"mixadd",attrs:{crmType:t.crmType,id:t.id},on:{"mixadd-info":t.submitInfo}}),t._v(" "),a("flexbox",{staticClass:"se-section"},[a("div",{staticClass:"se-name"},[t._v("记录类型")]),t._v(" "),a("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:t.handleTypeDrop}},[a("flexbox",{staticClass:"se-select"},[a("div",{staticClass:"se-select-name"},[t._v(t._s(t.followType?t.followType:"请选择"))]),t._v(" "),a("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.followTypes,function(e,i){return a("el-dropdown-item",{key:i,attrs:{command:e.type}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("div",{staticClass:"se-name"},[t._v("下次联系时间")]),t._v(" "),a("el-date-picker",{staticClass:"se-datepicker",attrs:{type:"datetime",placeholder:"选择日期","value-format":"yyyy-MM-dd HH:mm:ss",editable:!1},model:{value:t.next_time,callback:function(e){t.next_time=e},expression:"next_time"}}),t._v(" "),a("el-checkbox",{model:{value:t.is_event,callback:function(e){t.is_event=e},expression:"is_event"}},[t._v("添加到日程提醒")]),t._v(" "),a("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(e){return t.sendInfo(e)}}},[t._v("发布")])],1)],1),t._v(" "),a("div",{staticClass:"log-cont"},[t.logTypes.length>0?a("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},t._l(t.logTypes,function(e,i){return a("flexbox",{key:i,staticStyle:{width:"auto"},nativeOn:{click:function(a){t.logTabsClick(e,i)}}},[a("div",{staticClass:"log-tabs-item",style:{color:t.logType==e.type?"#F18C70":"#777"}},[t._v(t._s(e.name))]),t._v(" "),t.logTypes.length-1!=i?a("div",{staticClass:"log-tabs-line"}):t._e()])})):t._e(),t._v(" "),a("keep-alive",[a(t.componentsName,{tag:"component",attrs:{id:t.id,crmType:t.crmType}})],1)],1)])},[],!1,null,"4d2baace",null);v.options.__file="ContactsFollow.vue";var g=v.exports,_=a("U05J"),b=a("5j45"),y=a("8DbX"),w=a("C+sD"),C=a("EgJF"),x=(a("wd/R"),a("4+0Q")),D={name:"contacts-detail",components:{SlideView:s.a,CRMDetailHead:n.a,ContactsFollow:g,CRMBaseInfo:_.a,RelativeBusiness:b.a,RelativeHandle:y.a,RelativeFiles:w.a,CRMCreateView:C.default},mixins:[x.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"contacts",detailData:{},headDetails:[{title:"客户名称",value:""},{title:"职务",value:""},{title:"手机",value:""},{title:"更新时间",value:""}],tabCurrentName:"followlog",isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"contacts-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"business"==this.tabCurrentName?"relative-business":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""},tabnames:function(){var t=[];return t.push({label:"跟进记录",name:"followlog"}),this.crm.contacts&&this.crm.contacts.read&&t.push({label:"基本信息",name:"basicinfo"}),this.crm.business&&this.crm.business.index&&t.push({label:"商机",name:"business"}),t.push({label:"附件",name:"file"}),t.push({label:"操作记录",name:"operationlog"}),t}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(i.c)({id:this.id}).then(function(e){t.loading=!1,t.detailData=e.data,t.headDetails[0].value=e.data.customer_id_info?e.data.customer_id_info.name:"",t.headDetails[1].value=e.data.post,t.headDetails[2].value=e.data.mobile,t.headDetails[3].value=e.data.update_time}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},editSaveSuccess:function(){this.getDetial()}}},k=(a("kxFR"),Object(f.a)(D,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{listenerIDs:t.listenerIDs,noListenerIDs:t.noListenerIDs,noListenerClass:t.noListenerClass,"body-style":{padding:0,height:"100%"}},on:{"side-close":t.hideView}},[t.canShowDetail?a("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限",direction:"column",align:"stretch"}},[a("c-r-m-detail-head",{attrs:{crmType:"contacts",detail:t.detailData,headDetails:t.headDetails,id:t.id},on:{handle:t.detailHeadHandle,close:t.hideView}}),t._v(" "),a("div",{staticClass:"tabs"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return a("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),a("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[a("keep-alive",[a(t.tabName,{tag:"component",attrs:{crmType:"contacts",detail:t.detailData,id:t.id}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?a("c-r-m-create-view",{attrs:{"crm-type":"contacts",action:{type:"update",id:this.id}},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"7ff0b8ec",null));k.options.__file="ContactsDetail.vue";e.a=k.exports},QD92:function(t,e,a){"use strict";var i=a("NOa9");a.n(i).a},QJC7:function(t,e,a){"use strict";var i=a("7Qib"),s={name:"follow-record-cell",components:{CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-682f"),a.e("chunk-6f45"),a.e("chunk-a259"),a.e("chunk-e306"),a.e("chunk-a614")]).then(a.bind(null,"uMjE"))}},props:{item:{type:Object,default:function(){return{}}},crmType:{type:String,default:""}},data:function(){return{showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{},mounted:function(){},methods:{previewImg:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,a){return t.url=t.file_path,t})})},downloadFile:function(t){Object(i.a)({path:t.file_path,name:t.name})},checkRelationDetail:function(t,e){this.relationID=e,this.relationCrmType=t,this.showFullDetail=!0}}},n=(a("4f+9"),a("KHd+")),l=Object(n.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fl-c"},[i("flexbox",{staticClass:"fl-h"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:t.item.create_user_info,expression:"item.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.item.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(item.create_user_info.thumb_img)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),t._v(" "),i("div",{staticClass:"fl-h-b"},[i("div",{staticClass:"fl-h-name"},[t._v(t._s(t.item.create_user_info.realname))]),t._v(" "),i("div",{staticClass:"fl-h-time"},[t._v(t._s(t._f("filterTimestampToFormatTime")(t.item.create_time,"YYYY-MM-DD HH:mm")))])]),t._v(" "),i("flexbox",{staticClass:"fl-h-mark"},[i("img",{staticClass:"fl-h-mark-img",attrs:{src:a("N0PQ")}}),t._v(" "),i("div",{staticClass:"fl-h-mark-name"},[t._v("跟进记录")])])],1),t._v(" "),i("div",{staticClass:"fl-b"},[i("div",{staticClass:"fl-b-content"},[t._v(t._s(t.item.content))]),t._v(" "),t.item.dataInfo.imgList&&t.item.dataInfo.imgList.length>0?i("flexbox",{staticClass:"fl-b-images",attrs:{wrap:"wrap"}},t._l(t.item.dataInfo.imgList,function(e,a){return i("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.file_path_thumb,expression:"file.file_path_thumb",arg:"background-image"}],key:e.file_path_thumb,staticClass:"fl-b-img-item",on:{click:function(e){t.previewImg(t.item.dataInfo.imgList,a)}}})})):t._e(),t._v(" "),t.item.dataInfo.fileList&&t.item.dataInfo.fileList.length>0?i("div",{staticClass:"fl-b-files"},t._l(t.item.dataInfo.fileList,function(e,s){return i("flexbox",{key:s,staticClass:"cell"},[i("img",{staticClass:"cell-head",attrs:{src:a("6KEE")}}),t._v(" "),i("div",{staticClass:"cell-body"},[t._v(t._s(e.name)),i("span",{staticStyle:{color:"#ccc"}},[t._v("（"+t._s(e.size)+"）")])]),t._v(" "),i("i",{staticClass:"el-icon-download cell-foot",staticStyle:{cursor:"pointer",color:"#ccc"},on:{click:function(a){t.downloadFile(e)}}})])})):t._e(),t._v(" "),t.item.category||t.item.next_time?i("div",{staticClass:"follow"},[t.item.category?i("span",{staticClass:"follow-info"},[t._v(t._s(t.item.category))]):t._e(),t._v(" "),t.item.next_time?i("span",{staticClass:"follow-info"},[t._v(t._s(t._f("filterTimestampToFormatTime")(t.item.next_time,"YYYY-MM-DD HH:mm:ss")))]):t._e()]):t._e(),t._v(" "),t.item.dataInfo.contactsList&&t.item.dataInfo.contactsList.length>0?i("div",{staticClass:"fl-b-other"},[i("div",{staticClass:"fl-b-other-name"},[t._v("关联联系人")]),t._v(" "),i("div",t._l(t.item.dataInfo.contactsList,function(e,a){return i("flexbox",{key:a,staticClass:"cell",nativeOn:{click:function(a){t.checkRelationDetail("contacts",e.contacts_id)}}},[i("i",{staticClass:"wukong wukong-contacts cell-head crm-type",style:{opacity:0==a?1:0}}),t._v(" "),i("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.name))])])}))]):t._e(),t._v(" "),t.item.dataInfo.businessList&&t.item.dataInfo.businessList.length>0?i("div",{staticClass:"fl-b-other"},[i("div",{staticClass:"fl-b-other-name"},[t._v("关联商机")]),t._v(" "),i("div",t._l(t.item.dataInfo.businessList,function(e,a){return i("flexbox",{key:a,staticClass:"cell",nativeOn:{click:function(a){t.checkRelationDetail("business",e.business_id)}}},[i("i",{staticClass:"wukong wukong-business cell-head crm-type",style:{opacity:0==a?1:0}}),t._v(" "),i("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.name))])])}))]):t._e()],1),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.relationCrmType,id:t.relationID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"4d2a7a8c",null);l.options.__file="FollowRecordCell.vue";var o=l.exports,c=a("KzkL"),r={name:"record-log",components:{FollowRecordCell:o},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},mounted:function(){var t=this;this.$bus.on("follow-log-refresh",function(e){"record-log"==e.type&&t.refreshList()});var e=this,a=document.getElementById("follow-log-content");a.onscroll=function(){a.scrollTop+a.clientHeight==a.scrollHeight&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(c.h)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"record"}).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()}},beforeDestroy:function(){this.$bus.off("follow-log-refresh")}},d=(a("qSEU"),Object(n.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,i){return a("follow-record-cell",{key:i,attrs:{item:e,crmType:t.crmType}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)])])},[],!1,null,"283f90d1",null));d.options.__file="RecordLog.vue";e.a=d.exports},QTVK:function(t,e,a){},Qldq:function(t,e,a){"use strict";a.d(e,"f",function(){return s}),a.d(e,"a",function(){return n}),a.d(e,"e",function(){return l}),a.d(e,"c",function(){return o}),a.d(e,"d",function(){return c}),a.d(e,"b",function(){return r}),a.d(e,"g",function(){return d});var i=a("t3Un");function s(t){return Object(i.a)({url:"oa/log/index",method:"post",data:t})}function n(t){return Object(i.a)({url:"oa/log/save",method:"post",data:t})}function l(t){return Object(i.a)({url:"oa/log/update",method:"post",data:t})}function o(t){return Object(i.a)({url:"oa/log/commentSave",method:"post",data:t})}function c(t){return Object(i.a)({url:"oa/log/delete",method:"post",data:t})}function r(t){return Object(i.a)({url:"oa/log/commentDel",method:"post",data:t})}function d(t){return Object(i.a)({url:"oa/log/setread",method:"post",data:t})}},S3Kq:function(t,e,a){"use strict";var i=a("GQeE"),s=a.n(i),n=a("sCIN"),l={name:"emoji",data:function(){return{emojiData:n.a,pannels:["表情","自然","物品","地点","符号"],activeIndex:0}},created:function(){},methods:{changeActive:function(t){this.activeIndex=t},getPureName:function(t){return t.replace(/:/g,"")},selectItem:function(t){this.$emit("select",t)}},computed:{emojis:function(){var t=this;return this.pannels.map(function(e){return s()(t.emojiData[e])})}}},o=(a("+QVO"),a("KHd+")),c=Object(o.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"emoji"},[a("ul",{staticClass:"emoji-controller"},t._l(t.pannels,function(e,i){return a("li",{key:i,class:{active:i===t.activeIndex},on:{click:function(e){t.changeActive(i)}}},[t._v("\n      "+t._s(e)+"\n    ")])})),t._v(" "),a("ul",{staticClass:"emoji-container"},t._l(t.emojis,function(e,i){return i===t.activeIndex?a("li",{key:i,staticStyle:{padding:"0"}},[t._v("\n      "+t._s(e)+"--"+t._s(i)+"\n      "),t._l(e,function(e,i){return a("a",{key:i,attrs:{href:"javascript:;"},on:{click:function(a){t.selectItem(e)}}},[a("span",{staticClass:"emoji-item",class:"sprite-"+t.getPureName(e),attrs:{title:e}})])})],2):t._e()}))])},[],!1,null,"4f303d0e",null);c.options.__file="emoji.vue";e.a=c.exports},SZpf:function(t,e,a){"use strict";var i=a("9ZUK");a.n(i).a},SbwO:function(t,e,a){"use strict";var i=a("XxXa");a.n(i).a},T8AV:function(t,e,a){"use strict";var i=a("ulRd");a.n(i).a},Tkr5:function(t,e,a){},UEWd:function(t,e,a){"use strict";var i=a("7Qib"),s=a("KTTK"),n={name:"mix-add",components:{CrmRelative:a("mkuN").a},props:{showRelativeBusiness:{type:Boolean,default:!1},showRelativeContacts:{type:Boolean,default:!1},id:[String,Number],crmType:{type:String,default:""}},data:function(){return{content:"",inputAutosize:{minRows:1,maxRows:6},barItems:[{img:a("S1Xc"),title:"图片",type:"img",data:"image/*"},{img:a("rl4O"),title:"附件",type:"file",data:"*.*"}],imgFiles:[],files:[],business:[],contacts:[],showRelativeType:""}},computed:{},mounted:function(){this.showRelativeBusiness&&this.barItems.push({img:a("i91G"),title:"关联商机",type:"business",show:!1}),this.showRelativeContacts&&this.barItems.push({img:a("OPCT"),title:"关联联系人",type:"contacts",show:!1}),this.$on("submit-info",function(){this.$emit("mixadd-info",{content:this.content,files:this.files,images:this.imgFiles,business:this.business,contacts:this.contacts})})},methods:{resetInfo:function(){this.content="",this.imgFiles=[],this.files=[],this.business=[],this.contacts=[],this.showRelativeType=""},checkRelativeInfos:function(t){"business"==this.showRelativeType?this.business=t.data:"contacts"==this.showRelativeType&&(this.contacts=t.data)},barClick:function(t){"business"==t.type?(this.showRelativeType=t.type,t.show=!0):"contacts"==t.type&&(this.showRelativeType=t.type,t.show=!0)},uploadFile:function(t){for(var e=this,a=t.target.files,n=this,l=function(l){var o=a[l];(c={}).module_id=e.id,c.module="crm_"+e.crmType,"image/*"==t.target.accept?c["img[]"]=o:"*.*"==t.target.accept&&(c["file[]"]=o),Object(s.e)(c).then(function(e){e.data.forEach(function(e,a){e.size=Object(i.c)(o.size),"image/*"==t.target.accept?n.imgFiles.push(e):"*.*"==t.target.accept&&(e.icon=Object(i.f)(o),n.files.push(e))})}).catch(function(){})},o=0;o<a.length;o++){var c;l(o)}t.target.value=""},deleteAllImg:function(){this.imgFiles=[]},deleteImgOrFile:function(t,e,a){var i=this;Object(s.c)({save_name:e.save_name,module_id:this.id,module:"crm_"+this.crmType}).then(function(e){"image"==t?i.imgFiles.splice(a,1):i.files.splice(a,1),i.$message.success(e.data)}).catch(function(){})},mouseImgOver:function(t,e){t.showDelete=!0,this.$set(this.imgFiles,e,t)},mouseImgLeave:function(t,e){t.showDelete=!1,this.$set(this.imgFiles,e,t)},inputFocus:function(){var t=this;this.inputAutosize={minRows:3,maxRows:6},this.$nextTick(function(){t.$refs.textarea.resizeTextarea()})}},beforeDestroy:function(){this.$off("submit-info")}},l=(a("yNwx"),a("KHd+")),o=Object(l.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mix-container"},[i("div",{staticClass:"i-cont"},[i("el-input",{ref:"textarea",attrs:{type:"textarea",autosize:t.inputAutosize,clearable:"",resize:"none",placeholder:"请输入内容"},on:{focus:t.inputFocus},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),t.imgFiles.length>0?i("section",{staticClass:"img-cont"},[i("flexbox",{attrs:{wrap:"wrap"}},[t._l(t.imgFiles,function(e,a){return i("div",{key:a,staticClass:"img-item",style:{"background-image":"url("+e.path+")"},on:{mouseover:function(i){t.mouseImgOver(e,a)},mouseleave:function(i){t.mouseImgLeave(e,a)}}},[e.showDelete?i("div",{staticClass:"img-delete",on:{click:function(i){t.deleteImgOrFile("image",e,a)}}},[t._v("×")]):t._e()])}),t._v(" "),i("div",{staticClass:"img-item-add"},[i("input",{staticClass:"img-item-iput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.uploadFile}})])],2),t._v(" "),i("div",{staticClass:"img-bar",on:{click:t.deleteAllImg}},[t._v("全部删除")])],1):t._e(),t._v(" "),t.files.length>0?i("section",{staticClass:"file-cont"},[i("flexbox",{staticClass:"f-header"},[i("img",{staticClass:"f-logo",attrs:{src:a("rl4O")}}),t._v(" "),i("div",{staticClass:"f-name"},[t._v("附件")])]),t._v(" "),i("div",{staticClass:"f-body"},t._l(t.files,function(e,a){return i("flexbox",{key:a,staticClass:"f-item"},[i("img",{staticClass:"f-img",attrs:{src:e.icon}}),t._v(" "),i("div",{staticClass:"f-name"},[t._v(t._s(e.name+"("+e.size+")"))]),t._v(" "),i("div",{staticClass:"close-button",on:{click:function(i){t.deleteImgOrFile("file",e,a)}}},[t._v("×")])])})),t._v(" "),i("div",{staticClass:"img-bar",on:{click:function(e){t.files=[]}}},[t._v("全部删除")])],1):t._e(),t._v(" "),t.business.length>0?i("section",{staticClass:"c-cont"},[i("flexbox",{staticClass:"c-header"},[i("img",{staticClass:"c-logo",attrs:{src:a("i91G")}}),t._v(" "),i("div",{staticClass:"c-name"},[t._v("商机")])]),t._v(" "),i("div",{staticClass:"c-body"},[i("flexbox",{attrs:{wrap:"wrap"}},t._l(t.business,function(e,a){return i("flexbox",{key:a,staticClass:"c-item"},[i("div",{staticClass:"c-item-name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"c-item-close",on:{click:function(e){t.business.splice(a,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),t.contacts.length>0?i("section",{staticClass:"c-cont"},[i("flexbox",{staticClass:"c-header"},[i("img",{staticClass:"c-logo",attrs:{src:a("OPCT")}}),t._v(" "),i("div",{staticClass:"c-name"},[t._v("联系人")])]),t._v(" "),i("div",{staticClass:"c-body"},[i("flexbox",{attrs:{wrap:"wrap"}},t._l(t.contacts,function(e,a){return i("flexbox",{key:a,staticClass:"c-item"},[i("div",{staticClass:"c-item-name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"c-item-close",on:{click:function(e){t.contacts.splice(a,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),i("flexbox",{staticClass:"bar-cont"},[t._l(t.barItems,function(e,a){return["img"==e.type||"file"==e.type?i("flexbox",{key:a,staticClass:"bar-item",nativeOn:{click:function(a){t.barClick(e)}}},[i("input",{staticClass:"bar-input",attrs:{type:"file",accept:e.data,multiple:""},on:{change:t.uploadFile}}),t._v(" "),i("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),i("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])]):i("el-popover",{key:a,attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.show,callback:function(a){t.$set(e,"show",a)},expression:"item.show"}},[i("crm-relative",{ref:"crmrelative",refInFor:!0,attrs:{show:e.show,radio:!1,action:{type:"condition",data:{form_type:"customer",customer_id:t.id}},selectedData:"business"==e.type?{business:t.business}:{contacts:t.contacts},"crm-type":e.type},on:{close:function(t){e.show=!1},changeCheckout:t.checkRelativeInfos}}),t._v(" "),i("flexbox",{staticClass:"bar-item",attrs:{slot:"reference"},nativeOn:{click:function(a){t.barClick(e)}},slot:"reference"},[i("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),i("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])])],1)]})],2)],1)},[],!1,null,"72849f50",null);o.options.__file="MixAdd.vue";e.a=o.exports},UxBq:function(t,e,a){"use strict";var i=a("753O");a.n(i).a},V3gP:function(t,e,a){},VuGW:function(t,e,a){"use strict";var i=a("V3gP");a.n(i).a},XCNI:function(t,e,a){"use strict";var i=a("1qNb");a.n(i).a},XxXa:function(t,e,a){},"aQg/":function(t,e,a){"use strict";var i=a("d0bK"),s=a("Op00"),n=a("KzkL"),l=a("7Qib"),o={name:"task-log",components:{TaskCell:s.a,Particulars:function(){return Promise.all([a.e("chunk-682f"),a.e("chunk-6f45"),a.e("chunk-a259"),a.e("chunk-c235")]).then(a.bind(null,"+Gvz"))}},props:{id:[String,Number],crmType:{type:String,default:""}},mixins:[i.a],watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){e.scrollTop+e.clientHeight==e.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(n.h)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"task"}).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},taskCellHandle:function(t){var e=this;"view"==t.type&&this.showDetailView(t.data.item,t.data.index,function(){e.$nextTick(function(){document.body.appendChild(e.$refs.taskShade),e.$refs.taskShade.style.zIndex=Object(l.g)(),e.$refs.taskShade.addEventListener("click",e.handleDocumentClick,!1)})})},handleDocumentClick:function(t){t.stopPropagation(),this.$refs.taskShade==t.target&&(this.taskDetailShow=!1)}}},c=(a("QD92"),a("KHd+")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,i){return a("task-cell",{key:i,attrs:{data:e.dataInfo,dataIndex:i},on:{"on-handle":t.taskCellHandle}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),t.taskDetailShow?a("div",{ref:"taskShade",staticClass:"full-container"},[a("particulars",{staticClass:"d-view",attrs:{id:t.taskID,detailIndex:t.detailIndex},on:{"on-handle":t.detailHandle,close:t.closeBtn}})],1):t._e()])},[],!1,null,"15beb9e6",null);r.options.__file="TaskLog.vue";e.a=r.exports},d0PY:function(t,e,a){},d0bK:function(t,e,a){"use strict";e.a={components:{},data:function(){return{taskID:"",detailIndex:-1,taskDetailShow:!1}},mounted:function(){},methods:{closeBtn:function(){this.taskDetailShow=!1},showDetailView:function(t,e,a){this.taskID=t.task_id,this.detailIndex=e,this.taskDetailShow=!0,a&&a()},detailHandle:function(t){if(0==t.index||t.index)if("title-check"==t.type)this.$set(this.list[t.index],"checked",t.value);else if("delete"==t.type)this.list.splice(t.index,1);else if("change-stop-time"==t.type){parseInt(t.value)+86399>new Date(new Date).getTime()/1e3?this.list[t.index].is_end=!1:this.list[t.index].is_end=!0,this.list[t.index].stop_time=t.value}else if("change-priority"==t.type)this.list[t.index].priority=t.value.id;else if("change-name"==t.type)this.list[t.index].task_name=t.value;else if("change-comments"==t.type){var e=this.list[t.index].commentcount;"add"==t.value?this.list[t.index].commentcount=e+1:this.list[t.index].commentcount=e-1}else"change-sub-task"==t.type&&(this.list[t.index].subdonecount=t.value.subdonecount,this.list[t.index].subcount=t.value.allcount-t.value.subdonecount)}},deactivated:function(){}}},etZQ:function(t,e,a){},ez40:function(t,e,a){},flEI:function(t,e,a){"use strict";var i=a("kJFR");a.n(i).a},gd5k:function(t,e,a){"use strict";var i=a("Fpl1"),s=a("+zsY"),n=a("KzkL"),l=a("ExMk"),o=(a("7Qib"),{name:"examine-log",components:{ExamineCell:i.a,CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-682f"),a.e("chunk-6f45"),a.e("chunk-a259"),a.e("chunk-1137")]).then(a.bind(null,"uMjE"))},ExamineHandle:function(){return a.e("chunk-7328").then(a.bind(null,"QhmF"))},ExamineCreateView:s.a},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showExamineHandle:!1,isCreate:!1,createAction:{type:"save"},createInfo:{},showFullDetail:!1,detailCRMType:""}},computed:{},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){e.scrollTop+e.clientHeight==e.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(n.h)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"examine"}).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(t){var e=this;"edit"==t.type?(t.data.item.title=t.data.item.category_name,this.createInfo=t.data.item,this.createAction={type:"update",id:t.data.item.examine_id,data:t.data.item},this.isCreate=!0):"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.c)({id:t.data.item.examine_id}).then(function(t){e.refreshList(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"withdraw"==t.type?(this.rowID=t.data.item.examine_id,this.showExamineHandle=!0):"view"==t.type?(this.detailCRMType="examine",this.rowID=t.data.item.examine_id,this.showFullDetail=!0):"related-detail"==t.type&&(this.rowID=t.data.item[t.data.type+"_id"],this.detailCRMType=t.data.type,this.showFullDetail=!0)}}}),c=(a("H5CR"),a("KHd+")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,i){return a("examine-cell",{key:i,attrs:{data:e.dataInfo},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),a("examine-handle",{attrs:{show:t.showExamineHandle,id:t.rowID,examineType:"oa_examine",status:"2"},on:{close:function(e){t.showExamineHandle=!1},save:t.refreshList}}),t._v(" "),t.isCreate?a("examine-create-view",{attrs:{category_id:t.createInfo.category_id,category_title:t.createInfo.title,action:t.createAction},on:{"save-success":t.refreshList,"hiden-view":function(e){t.isCreate=!1}}}):t._e(),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"72ad3372",null);r.options.__file="ExamineLog.vue";e.a=r.exports},gs4d:function(t,e,a){},i91G:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU2RjI0NjM0RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU2RjI0NjM1RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTZGMjQ2MzJFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTZGMjQ2MzNFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4H2LzoAAAAnklEQVR42mI8c+YMA7WAsbExAxMDlQGygSuA+B8Q/8eD/0HV4QQsSOwwNAtwAZChEcS4kJFIXzES62WqhyFdDESOqH1ocjuwRRQLAQPxRZQHEvsvLKKYKIkAbD5FNvA/kZr/ExuGq5HC6wiauo1I4bWa2IQdDsXYgP+gTTZUN5DYiPpHbDqERRQjAUtXE2sgvojCnnD///8/uCMFIMAAVWsql9WKpTgAAAAASUVORK5CYII="},iz1I:function(t,e,a){"use strict";var i=a("51oS");a.n(i).a},kJFR:function(t,e,a){},kxFR:function(t,e,a){"use strict";var i=a("yZyq");a.n(i).a},lcKN:function(t,e,a){},mNQR:function(t,e,a){},mYOy:function(t,e,a){},mqlf:function(t,e,a){"use strict";var i=a("5tgW"),s=a("Ew9n"),n=a("F03V"),l=a("UEWd"),o=a("QJC7"),c=a("KzkL"),r=a("7Qib"),d={name:"clue-follow",components:{MixAdd:l.a,RecordLog:o.a},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{},data:function(){return{sendLoading:!1,followTypes:[{type:"打电话",name:"打电话"},{type:"发邮件",name:"发邮件"},{type:"发短信",name:"发短信"},{type:"见面拜访",name:"见面拜访"},{type:"活动",name:"活动"}],followType:"打电话",next_time:"",is_event:!1,logType:"record",logTypes:[]}},computed:{componentsName:function(){return"record"==this.logType?"RecordLog":""}},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(t){this.followType=t},logTabsClick:function(t,e){this.logType=t.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(t){var e=this;if(!this.is_event||this.next_time){var a={};a.types="crm_"+this.crmType,a.types_id=this.id,a.content=t.content,a.category=this.followType;var i=t.images.map(function(t,e,a){return t.file_id}),s=t.files.map(function(t,e,a){return t.file_id});a.file_id=i.concat(s),this.next_time&&(a.is_event=this.is_event?1:0,a.next_time=Object(r.d)(this.next_time)),this.sendLoading=!0,Object(c.i)(a).then(function(t){e.sendLoading=!1,e.$message.success(t.data),e.$refs.mixadd.resetInfo(),e.is_event=!1,e.next_time="",e.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){e.sendLoading=!1})}else this.$message.error("请选择下次联系时间")}}},u=(a("SZpf"),a("KHd+")),m=Object(u.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"f-container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sendLoading,expression:"sendLoading"}]},[a("mix-add",{ref:"mixadd",attrs:{crmType:t.crmType,id:t.id},on:{"mixadd-info":t.submitInfo}}),t._v(" "),a("flexbox",{staticClass:"se-section"},[a("div",{staticClass:"se-name"},[t._v("记录类型")]),t._v(" "),a("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:t.handleTypeDrop}},[a("flexbox",{staticClass:"se-select"},[a("div",{staticClass:"se-select-name"},[t._v(t._s(t.followType?t.followType:"请选择"))]),t._v(" "),a("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.followTypes,function(e,i){return a("el-dropdown-item",{key:i,attrs:{command:e.type}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("div",{staticClass:"se-name"},[t._v("下次联系时间")]),t._v(" "),a("el-date-picker",{staticClass:"se-datepicker",attrs:{type:"datetime",placeholder:"选择日期","value-format":"yyyy-MM-dd HH:mm:ss",editable:!1},model:{value:t.next_time,callback:function(e){t.next_time=e},expression:"next_time"}}),t._v(" "),a("el-checkbox",{model:{value:t.is_event,callback:function(e){t.is_event=e},expression:"is_event"}},[t._v("添加到日程提醒")]),t._v(" "),a("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(e){return t.sendInfo(e)}}},[t._v("发布")])],1)],1),t._v(" "),a("div",{staticClass:"log-cont"},[t.logTypes.length>0?a("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},t._l(t.logTypes,function(e,i){return a("flexbox",{key:i,staticStyle:{width:"auto"},nativeOn:{click:function(a){t.logTabsClick(e,i)}}},[a("div",{staticClass:"log-tabs-item",style:{color:t.logType==e.type?"#F18C70":"#777"}},[t._v(t._s(e.name))]),t._v(" "),t.logTypes.length-1!=i?a("div",{staticClass:"log-tabs-line"}):t._e()])})):t._e(),t._v(" "),a(t.componentsName,{tag:"component",attrs:{id:t.id,crmType:t.crmType}})],1)])},[],!1,null,"24a598a5",null);m.options.__file="ClueFollow.vue";var h=m.exports,p=a("U05J"),f=a("C+sD"),v=a("8DbX"),g=a("EgJF"),_=(a("wd/R"),a("4+0Q")),b={name:"clue-detail",components:{SlideView:s.a,CRMDetailHead:n.a,ClueFollow:h,CRMBaseInfo:p.a,RelativeFiles:f.a,RelativeHandle:v.a,CRMCreateView:g.default},mixins:[_.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"leads",detailData:{},headDetails:[{title:"姓名",value:""},{title:"线索来源",value:""},{title:"手机",value:""},{title:"负责人",value:""},{title:"更新时间",value:""}],tabnames:[{label:"跟进记录",name:"followlog"},{label:"基本信息",name:"basicinfo"},{label:"附件",name:"file"},{label:"操作记录",name:"operationlog"}],tabCurrentName:"followlog",isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"clue-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(i.f)({id:this.id}).then(function(e){t.detailData=e.data,t.headDetails[0].value=e.data.name,t.headDetails[1].value=e.data.source,t.headDetails[2].value=e.data.mobile,t.headDetails[3].value=e.data.owner_user_id_info?e.data.owner_user_id_info.realname:"",t.headDetails[4].value=e.data.update_time,t.loading=!1}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},editSaveSuccess:function(){this.getDetial()}}},y=(a("pvLF"),Object(u.a)(b,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{listenerIDs:t.listenerIDs,noListenerIDs:t.noListenerIDs,noListenerClass:t.noListenerClass,"body-style":{padding:0,height:"100%"}},on:{"side-close":t.hideView}},[t.canShowDetail?a("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限",direction:"column",align:"stretch"}},[a("c-r-m-detail-head",{attrs:{crmType:"leads",detail:t.detailData,headDetails:t.headDetails,id:t.id},on:{handle:t.detailHeadHandle,close:t.hideView}}),t._v(" "),a("div",{staticClass:"tabs"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return a("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),a("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[a("keep-alive",[a(t.tabName,{tag:"component",attrs:{crmType:"leads",id:t.id}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?a("c-r-m-create-view",{attrs:{"crm-type":"leads",action:{type:"update",id:this.id}},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"6ad392a0",null));y.options.__file="ClueDetail.vue";e.a=y.exports},mwXL:function(t,e,a){"use strict";a.r(e);var i=a("FyfS"),s=a.n(i),n=a("EVdn"),l=a.n(n),o=(a("Io7t"),a("rNC5"),a("SzGA"),a("BuGm")),c=a("sDJW"),r=a("Dh/N"),d=a("7Qib"),u=a("wd/R"),m=a.n(u),h={components:{createSchedule:o.default,VDetails:c.a},data:function(){return{showDialog:!1,hoverDialogList:{},dialogVisible:!1,formData:{checkList:[]},newtext:"",loading:!0,listData:{}}},watch:{$route:function(t,e){this.$router.go(0)}},created:function(){var t=this;l()(function(){t.listFun()})},methods:{listFun:function(){var t=this;l()("#calendar").fullCalendar({height:document.documentElement.clientHeight-101,nextDayThreshold:"00:00:00",dayClick:function(e,a,i){t.newText="创建日程",t.showDialog=!0,t.formData={start_time:e._i,end_time:e._i,checkList:[]}},eventClick:function(e,a){var i=[];i.push(e.start_time,e.end_time),e.time=i,t.listData=e,t.showParticulars(e)},header:{left:"today,   agendaDay,agendaWeek,month",center:"prevYear,prev, title, next,nextYear",right:""},eventMouseover:function(e,a,i){t.$refs.hoverDialog.style.display="block",t.$refs.hoverDialog.style.width=document.getElementsByClassName("fc-day")[0].offsetWidth+"px",t.$refs.hoverDialog.style.left=a.currentTarget.offsetLeft-5+"px",t.$refs.hoverDialog.style.top=a.clientY-a.offsetY-60+"px",t.hoverDialogList={time:e.start._i,start_time:e.start_time,end_time:e.end_time,text:e.title,color:e.color,priority:e.priority}},eventMouseout:function(e,a,i){t.$refs.hoverDialog.style.display="none"},events:function(e,a,i,s){t.loading=!0;var n=parseInt(e._i/1e3),l=parseInt(a._i/1e3);Object(r.d)({start_time:n,end_time:l}).then(function(e){var a=e.data.list.map(function(t){return t.start=m()(Object(d.e)(t.start_time)).format("YYYY-MM-DD HH:mm:ss"),t.end=m()(Object(d.e)(t.end_time)).format("YYYY-MM-DD HH:mm:ss"),t.textColor="#333",t});s(a),t.loading=!1}).catch(function(e){t.loading=!1})}})},showParticulars:function(t){this.dialogVisible=!0},handleClose:function(){this.dialogVisible=!1},deleteClose:function(t){l()("#calendar").fullCalendar("refetchEvents"),this.handleClose()},editBtn:function(t){this.newText="编辑日程";var e=[],a=!0,i=!1,n=void 0;try{for(var l,o=s()(t.time);!(a=(l=o.next()).done);a=!0){var c=l.value;e.push(1e3*c)}}catch(t){i=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw n}}t.start_time=e[0],t.end_time=e[1],this.formData=t,this.handleClose(),this.showDialog=!0},newTask:function(){this.newText="创建日程",this.showDialog=!0,this.formData={checkList:[]}},closeDialog:function(){this.showDialog=!1},onSubmit:function(t,e){"创建日程"==this.newText?(this.$message.success("新建成功"),l()("#calendar").fullCalendar("refetchEvents"),this.closeDialog()):(this.$message.success("编辑成功"),l()("#calendar").fullCalendar("refetchEvents"),this.closeDialog())}}},p=(a("FFF9"),a("flEI"),a("KHd+")),f=Object(p.a)(h,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-calendars"},[a("div",{staticClass:"add-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:t.newTask}},[t._v("\n      创建日程\n    ")])],1),t._v(" "),a("div",{ref:"hoverDialog",staticClass:"hover-dialog"},[a("div",{staticClass:"img-content"},[a("span",[t._v(t._s(t._f("moment")(t.hoverDialogList.start_time,"YYYY-MM-DD")))]),t._v(" "),t.hoverDialogList.end_time?a("span",[t._v(" - "+t._s(t._f("moment")(t.hoverDialogList.end_time,"YYYY-MM-DD")))]):t._e()]),t._v(" "),a("div",[t._v("\n      "+t._s(t.hoverDialogList.text)+"\n    ")])]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"calendar"}}),t._v(" "),t.showDialog?a("create-schedule",{attrs:{text:t.newText,formData:t.formData},on:{onSubmit:t.onSubmit,closeDialog:t.closeDialog}}):t._e(),t._v(" "),t.dialogVisible?a("v-details",{attrs:{dialogVisible:t.dialogVisible,listData:t.listData},on:{editBtn:t.editBtn,deleteClose:t.deleteClose,handleClose:t.handleClose}}):t._e()],1)},[],!1,null,"297a473d",null);f.options.__file="index.vue";e.default=f.exports},n1dw:function(t,e,a){"use strict";var i=a("UcQx"),s=a("Ew9n"),n=a("F03V"),l=a("UEWd"),o=a("QJC7"),c=a("8KPp"),r=a("gd5k"),d=a("aQg/"),u=a("y9lt"),m=a("KzkL"),h=a("7Qib"),p={name:"business-follow",components:{MixAdd:l.a,RecordLog:o.a,JournalLog:c.a,ExamineLog:r.a,TaskLog:d.a,ScheduleLog:u.a},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{},data:function(){return{sendLoading:!1,followTypes:[{type:"打电话",name:"打电话"},{type:"发邮件",name:"发邮件"},{type:"发短信",name:"发短信"},{type:"见面拜访",name:"见面拜访"},{type:"活动",name:"活动"}],followType:"打电话",next_time:"",is_event:!1,logType:"record",logTypes:[{type:"record",name:"跟进记录"},{type:"log",name:"日志"},{type:"examine",name:"审批"},{type:"task",name:"任务"},{type:"schedule",name:"日程"}]}},computed:{componentsName:function(){return"record"==this.logType?"RecordLog":"log"==this.logType?"JournalLog":"examine"==this.logType?"ExamineLog":"task"==this.logType?"TaskLog":"schedule"==this.logType?"ScheduleLog":""}},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(t){this.followType=t},logTabsClick:function(t,e){this.logType=t.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(t){var e=this;if(!this.is_event||this.next_time){var a={};a.types="crm_"+this.crmType,a.types_id=this.id,a.content=t.content,a.category=this.followType;var i=t.images.map(function(t,e,a){return t.file_id}),s=t.files.map(function(t,e,a){return t.file_id});a.file_id=i.concat(s),this.next_time&&(a.is_event=this.is_event?1:0,a.next_time=Object(h.d)(this.next_time)),this.sendLoading=!0,Object(m.i)(a).then(function(t){e.sendLoading=!1,e.$message.success(t.data),e.$refs.mixadd.resetInfo(),e.is_event=!1,e.next_time="",e.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){e.sendLoading=!1})}else this.$message.error("请选择下次联系时间")}}},f=(a("T8AV"),a("KHd+")),v=Object(f.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"f-container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sendLoading,expression:"sendLoading"}]},[a("mix-add",{ref:"mixadd",attrs:{crmType:t.crmType,id:t.id},on:{"mixadd-info":t.submitInfo}}),t._v(" "),a("flexbox",{staticClass:"se-section"},[a("div",{staticClass:"se-name"},[t._v("记录类型")]),t._v(" "),a("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:t.handleTypeDrop}},[a("flexbox",{staticClass:"se-select"},[a("div",{staticClass:"se-select-name"},[t._v(t._s(t.followType?t.followType:"请选择"))]),t._v(" "),a("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.followTypes,function(e,i){return a("el-dropdown-item",{key:i,attrs:{command:e.type}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("div",{staticClass:"se-name"},[t._v("下次联系时间")]),t._v(" "),a("el-date-picker",{staticClass:"se-datepicker",attrs:{type:"datetime",placeholder:"选择日期","value-format":"yyyy-MM-dd HH:mm:ss",editable:!1},model:{value:t.next_time,callback:function(e){t.next_time=e},expression:"next_time"}}),t._v(" "),a("el-checkbox",{model:{value:t.is_event,callback:function(e){t.is_event=e},expression:"is_event"}},[t._v("添加到日程提醒")]),t._v(" "),a("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(e){return t.sendInfo(e)}}},[t._v("发布")])],1)],1),t._v(" "),a("div",{staticClass:"log-cont"},[a("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},t._l(t.logTypes,function(e,i){return a("flexbox",{key:i,staticStyle:{width:"auto"},nativeOn:{click:function(a){t.logTabsClick(e,i)}}},[a("div",{staticClass:"log-tabs-item",style:{color:t.logType==e.type?"#F18C70":"#777"}},[t._v(t._s(e.name))]),t._v(" "),t.logTypes.length-1!=i?a("div",{staticClass:"log-tabs-line"}):t._e()])})),t._v(" "),a("keep-alive",[a(t.componentsName,{tag:"component",attrs:{id:t.id,crmType:t.crmType}})],1)],1)])},[],!1,null,"f4e18012",null);v.options.__file="BusinessFollow.vue";var g=v.exports,_=a("U05J"),b=a("cYid"),y=a("8DbX"),w=a("DUlf"),C=a("SE13"),x=a("C+sD"),D=a("EgJF"),k=(a("wd/R"),a("4+0Q")),L={name:"business-detail",components:{SlideView:s.a,CRMDetailHead:n.a,BusinessFollow:g,CRMBaseInfo:_.a,RelativeContract:b.a,RelativeHandle:y.a,RelativeTeam:w.a,RelativeProduct:C.a,RelativeFiles:x.a,CRMCreateView:D.default},mixins:[k.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"business",detailData:{},headDetails:[{title:"客户名称",value:""},{title:"商机金额（元）",value:""},{title:"商机状态",value:""},{title:"负责人",value:""},{title:"创建时间",value:""}],tabCurrentName:"followlog",status:[],statuHandleItems:[{name:"赢单",type:1,value:"100%",img:a("y4JV")},{name:"输单",type:2,value:"0%",img:a("migV")},{name:"无效",type:3,value:"0%",img:a("x8Bg")}],isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"business-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"team"==this.tabCurrentName?"relative-team":"contract"==this.tabCurrentName?"relative-contract":"operationlog"==this.tabCurrentName?"relative-handle":"product"==this.tabCurrentName?"relative-product":"file"==this.tabCurrentName?"relative-files":""},tabnames:function(){var t=[];return t.push({label:"跟进记录",name:"followlog"}),this.crm.business&&this.crm.business.read&&t.push({label:"基本信息",name:"basicinfo"}),this.crm.product&&this.crm.product.index&&t.push({label:"产品",name:"product"}),this.crm.contract&&this.crm.contract.index&&t.push({label:"合同",name:"contract"}),t.push({label:"相关团队",name:"team"}),t.push({label:"附件",name:"file"}),t.push({label:"操作记录",name:"operationlog"}),t}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(i.e)({id:this.id}).then(function(e){t.loading=!1,t.detailData=e.data,t.handleBusinessStatus(e.data),t.headDetails[0].value=e.data.customer_id_info?e.data.customer_id_info.name:"",t.headDetails[1].value=e.data.money,t.headDetails[2].value=e.data.status_id_info,t.headDetails[3].value=e.data.owner_user_id_info?e.data.owner_user_id_info.realname:"",t.headDetails[4].value=e.data.update_time}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},handleBusinessStatus:function(t){this.status=[];var e=t.status_list.status,a=t.status_id;if(e){for(var i=!1,s=0,n=0;n<e.length;n++){var l=e[n];0===a?0!=t.is_end?1==t.is_end?l.class="state-suc":l.class="state-invalid":l.class="state-undo":l.status_id===a?(l.class="state-suc",l.isdoing=!0,i=!0,s=n):i?0!=t.is_end?1==t.is_end?l.class="state-suc":l.class="state-invalid":l.class="state-undo":l.class="state-suc",this.status.push(l)}var o={type:t.is_end};0==t.is_end?(o.name="结束",o.overIcon=["el-icon-arrow-down","el-icon--right"],s==e.length-1?o.class="state-doing":(this.status.length>0&&0!=a&&(this.status[s+1].class="state-doing"),o.class="state-undo")):1==t.is_end?(o.name="赢单",o.title="赢单",o.detail="赢单率100%",o.overIcon=["el-icon-check","el-icon--right"],o.class="state-suc"):2==t.is_end?(o.name="输单",o.title="赢单率0%",o.detail=t.remark,o.overIcon=["el-icon-circle-close","el-icon--right"],o.class="state-fail"):3==t.is_end&&(o.name="无效",o.title="赢单率0%",o.detail=t.remark,o.overIcon=["el-icon-remove-outline","el-icon--right"],o.class="state-invalid"),this.status.push(o)}},handleStatuChange:function(t,e){var a=this;if(0==this.detailData.is_end&&!t.isdoing){var s="确定进入"+t.name+"阶段";this.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.loading=!0,Object(i.a)({business_id:a.id,status_id:t.status_id}).then(function(t){a.loading=!1,a.$message.success(t.data),a.getDetial()}).catch(function(){a.loading=!1})}).catch(function(){a.$message({type:"info",message:"已取消操作"})})}},handleStatuResult:function(t,e){var a=this;if(0==this.detailData.is_end)if(2==t.type||3==t.type){var s="请填写"+t.name+"原因：",n=t.name+"原因";this.$prompt(s,n,{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){var s=e.value;a.loading=!0,Object(i.a)({business_id:a.id,status_id:t.status_id,is_end:t.type,remark:s}).then(function(t){a.loading=!1,a.$message.success(t.data),a.getDetial()}).catch(function(){a.loading=!1})}).catch(function(){a.$message({type:"info",message:"取消输入"})})}else{s="确定将当前商机设为"+t.name+"吗?";this.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.loading=!0,Object(i.a)({business_id:a.id,status_id:t.status_id,is_end:t.type}).then(function(t){a.loading=!1,a.$message.success(t.data),a.getDetial()}).catch(function(){a.loading=!1})}).catch(function(){a.$message({type:"info",message:"已取消操作"})})}},editSaveSuccess:function(){this.getDetial()}}},I=(a("BMif"),Object(f.a)(L,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{listenerIDs:t.listenerIDs,noListenerIDs:t.noListenerIDs,noListenerClass:t.noListenerClass,"body-style":{padding:0,height:"100%"}},on:{"side-close":t.hideView}},[t.canShowDetail?a("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限",direction:"column",align:"stretch"}},[a("c-r-m-detail-head",{attrs:{crmType:"business",detail:t.detailData,headDetails:t.headDetails,id:t.id},on:{handle:t.detailHeadHandle,close:t.hideView}},[a("div",{staticClass:"busi-line"})]),t._v(" "),t.status.length>0?a("div",{staticStyle:{padding:"10px 50px"}},[a("flexbox",{staticClass:"busi-state",style:{opacity:(t.detailData.is_end,1)}},t._l(t.status,function(e,i){return a("a",{key:i},[a("el-popover",{attrs:{placement:"bottom",title:e.name,width:"150",trigger:"hover",content:"赢单率"+e.rate+"%"}},[t.status.length-1!=i?a("div",{staticClass:"busi-state-item",class:e.class,attrs:{slot:"reference"},on:{click:function(a){t.handleStatuChange(e,i)}},slot:"reference"},[t._v("\n              "+t._s(e.name)+"\n              "),0==i?a("div",{staticClass:"state-circle circle-left"}):t._e(),t._v(" "),0!=i?a("div",{staticClass:"state-arrow arrow-left"}):t._e(),t._v(" "),a("div",{staticClass:"state-arrow arrow-right"})]):t._e()]),t._v(" "),t.status.length-1==i?a("el-popover",{attrs:{placement:"bottom",title:0==e.type?"":e.title,content:0==e.type?"":e.detail,width:"150",trigger:"hover"}},[0==e.type?a("div",{staticClass:"state-handel-cont"},t._l(t.statuHandleItems,function(e,i){return a("flexbox",{key:i,staticClass:"state-handel-item",nativeOn:{click:function(a){t.handleStatuResult(e,i)}}},[a("img",{staticClass:"state-handel-item-img",attrs:{src:e.img}}),t._v(" "),a("div",{staticClass:"state-handel-item-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"state-handel-item-value"},[t._v(t._s(e.value))])])})):t._e(),t._v(" "),a("div",{staticClass:"busi-state-item",class:e.class,attrs:{slot:"reference"},slot:"reference"},[a("i",{class:e.overIcon,staticStyle:{"margin-right":"8px"}}),t._v("\n              "+t._s(e.name)+"\n              "),a("div",{staticClass:"state-arrow arrow-left"}),t._v(" "),a("div",{staticClass:"state-circle circle-right"})])]):t._e()],1)}))],1):t._e(),t._v(" "),a("div",{staticClass:"tabs"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return a("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),a("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[a("keep-alive",[a(t.tabName,{tag:"component",attrs:{crmType:"business",detail:t.detailData,id:t.id}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?a("c-r-m-create-view",{attrs:{"crm-type":"business",action:{type:"update",id:this.id}},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"2a367692",null));I.options.__file="BusinessDetail.vue";e.a=I.exports},njnu:function(t,e,a){"use strict";var i=a("zDRf");a.n(i).a},o4Pz:function(t,e,a){"use strict";var i=a("Tkr5");a.n(i).a},pWrs:function(t,e,a){"use strict";var i=a("lcKN");a.n(i).a},pvLF:function(t,e,a){"use strict";var i=a("ez40");a.n(i).a},qSEU:function(t,e,a){"use strict";var i=a("9HXj");a.n(i).a},qnaT:function(t,e,a){},rl4O:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUzM0EzN0E0RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUzM0EzN0E1RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTMzQTM3QTJFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTMzQTM3QTNFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7neeY0AAABL0lEQVR42syUv0tCURSA1Vzam5ya+h8ag5DG3GpqqsAiwVFoECJc+jGpCFZrLTpFUjQ7PPwjClxyiCY3+y6cB5fLud0rOXjhG965j++de865L5skSWaRK5dZ8JpHmIUG/MAA1v4jNLIWVKAO6/CmSWOFO3AAJbiCLVjVpLHCV9iAF3ke+6S5wDFr8Az78Ons29LHkNDImnAO3/AAZeU9I+3AZhrI/9EAU7Nd6egIbuEJJk5tL2RPzVCTpfGZ0qieZF/TMvTJzmT+TqzsbFnZ/pidYUORHcKNzF87JHMzPJXUB1ZsBY6gGyNzhUM4lhEYS6ztqZkqc4+8B1N4h4LSgH5I5gq/YFuRprL7kEwbm4kjrYrsLkbmuymp9AMu4VpGZhZz6fOeuJEWl+KP/SvAAHR5UyjSji44AAAAAElFTkSuQmCC"},sDJW:function(t,e,a){"use strict";var i=a("Dh/N"),s=a("1RnH"),n=a("uMjE"),l={components:{relatedBusiness:s.a,CRMFullScreenDetail:n.default},data:function(){return{list:[{label:"开始时间",value:"start_time",type:"time"},{label:"结束时间",value:"end_time",type:"time"},{label:"参与人",value:"ownerList",type:"ownerList"},{label:"创建人",value:"create_person",type:"create_person"},{label:"创建时间",value:"create_time",type:"create_time"},{label:"备注",value:"remark",type:"bz"}],allData:{},relatedID:"",relatedCRMType:"",showRelatedDetail:!1}},created:function(){var t=this.listData;switch(this.allData.business=t.businessList?t.businessList:"",this.allData.contacts=t.contactsList?t.contactsList:"",this.allData.contract=t.contractList?t.contractList:"",this.allData.customer=t.customerList?t.customerList:"",t.remindtype){case 0:t.remindtypeText="无";break;case 1:t.remindtypeText="准时提醒";break;case 2:t.remindtypeText="5分钟前";break;case 3:t.remindtypeText="15分钟前";break;case 4:t.remindtypeText="30分钟前";break;case 5:t.remindtypeText="一个小时前";break;case 6:t.remindtypeText="二个小时前";break;case 7:t.remindtypeText="一天前";break;case 8:t.remindtypeText="二天前";break;case 9:t.remindtypeText="一周前"}},props:{dialogVisible:Boolean,listData:Object,btnShow:{type:Boolean,default:!0}},methods:{handleClose:function(){this.$emit("handleClose")},deleteClose:function(){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.b)({event_id:t.listData.event_id}).then(function(e){t.$emit("deleteClose",t.listData),t.$message({type:"success",message:"删除成功!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},editBtn:function(){this.$emit("editBtn",this.listData)},checkRelatedDetail:function(t,e){this.relatedID=e.key,this.relatedCRMType=t,this.showRelatedDetail=!0}}},o=(a("iz1I"),a("KHd+")),c=Object(o.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"details"},[a("el-dialog",{attrs:{title:t.listData.title,visible:t.dialogVisible,width:"400px",modal:!1,top:"30vh","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"content"},[t._l(t.list,function(e,i){return a("div",{key:i,staticClass:"list-data"},[a("label",[t._v(t._s(e.label)+"：")]),t._v(" "),"time"==e.type&&t.listData.time?a("span",[t._v(t._s(t._f("moment")(t.listData[e.value],"YYYY-MM-DD HH:mm:ss")))]):"create_time"==e.type?a("span",[t._v(t._s(t._f("moment")(t.listData[e.value],"YYYY-MM-DD HH:mm:ss")))]):"ownerList"==e.type?a("span",{staticClass:"owner-list"},t._l(t.listData[e.value],function(e,i){return a("span",{key:i},[a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(e.realname))])]),t._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"k"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.thumb_img),expression:"$options.filters.filterUserLazyImg(k.thumb_img)",arg:"background-image"}],staticClass:"div-photo header-circle"})])],1)})):"remindtype"==e.type?a("span",[t._v(t._s(t.listData.remindtypeText))]):"create_person"==e.type?a("span",[t._v(t._s(t.listData.create_user_info.realname))]):"bz"==e.type?a("span",[t._v(t._s(t.listData[e.value]))]):t._e()])}),t._v(" "),a("related-business",{attrs:{marginLeft:"0",alterable:!1,allData:t.allData,alterableColor:"#666"},on:{checkRelatedDetail:t.checkRelatedDetail}})],2),t._v(" "),t.btnShow?a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.listData.permission&&1==t.listData.permission.is_update?a("el-button",{attrs:{type:"primary"},on:{click:t.editBtn}},[t._v("编辑")]):t._e(),t._v(" "),t.listData.permission&&1==t.listData.permission.is_delete?a("el-button",{attrs:{type:"danger"},on:{click:t.deleteClose}},[t._v("删除")]):t._e()],1):t._e()]),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showRelatedDetail,crmType:t.relatedCRMType,id:t.relatedID},on:{"update:visible":function(e){t.showRelatedDetail=e}}})],1)},[],!1,null,"1bc953ea",null);c.options.__file="details.vue";e.a=c.exports},uMjE:function(t,e,a){"use strict";a.r(e);var i=a("7Qib"),s=a("mqlf"),n=a("ppJE"),l=a("PS1M"),o=a("n1dw"),c=a("xfX+"),r=a("8gwX"),d=a("K6D0"),u=a("7z+D"),m={name:"c-r-m-full-screen-detail",components:{ClueDetail:s.a,CustomerDetail:n.a,ContactsDetail:l.a,BusinessDetail:o.a,ContractDetail:c.a,ProductDetail:r.a,MoneyDetail:d.a,ExamineDetail:u.a},watch:{visible:function(t){this.showDetail=t,t&&(document.body.appendChild(this.$el),this.$el.addEventListener("click",this.handleDocumentClick,!1),this.$el.style.zIndex=Object(i.g)())},showDetail:function(t){var e=this;t||setTimeout(function(){e.$emit("update:visible",!1)},350)}},computed:{tabName:function(){return"leads"==this.crmType?"clue-detail":"customer"==this.crmType?"customer-detail":"contacts"==this.crmType?"contacts-detail":"business"==this.crmType?"business-detail":"contract"==this.crmType?"contract-detail":"product"==this.crmType?"product-detail":"receivables"==this.crmType?"money-detail":"examine"==this.crmType?"examine-detail":""}},data:function(){return{showDetail:!1}},props:{id:[String,Number],crmType:{type:String,default:""},visible:{type:Boolean,default:!1}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.addEventListener("click",this.handleDocumentClick,!1),this.$el.style.zIndex=Object(i.g)())},methods:{hiddenView:function(){this.showDetail=!1},handleDocumentClick:function(t){t.stopPropagation(),this.$el==t.target&&(this.showDetail=!1)}},beforeDestroy:function(){this.$el&&this.$el.parentNode&&(this.$el.parentNode.removeChild(this.$el),this.$el.removeEventListener("click",this.handleDocumentClick,!1))}},h=(a("vl1X"),a("KHd+")),p=Object(h.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"full-container"},[t.id&&t.showDetail?a(t.tabName,{tag:"component",staticClass:"d-view",attrs:{crmType:t.crmType,id:t.id},on:{"hide-view":t.hiddenView}}):t._e()],1)},[],!1,null,"2471320a",null);p.options.__file="CRMFullScreenDetail.vue";e.default=p.exports},ulRd:function(t,e,a){},vl1X:function(t,e,a){"use strict";var i=a("+kCF");a.n(i).a},wWfP:function(t,e,a){},woiz:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhGQTE4Q0EzRjM4ODExRThCNjlDOEQxMEUxMzYwREE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhGQTE4Q0E0RjM4ODExRThCNjlDOEQxMEUxMzYwREE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEZBMThDQTFGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEZBMThDQTJGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4R34ZtAAABfUlEQVR42pzUPUsDQRDG8eTQVBZiQhqxU6KoWKiFhaAQ21gqQcXGTxDFSsRKBOMXsBGi+NLFlBYighbmClGLgFZiE1+wECGd/4HnZDmSIA78uNzN7LC3t5touVyOhKINS5jGIDrwgTsUsYsvd4AXapBFBaPIoxdRXfN6XlHdb7Q4v9exgAz8UPNXlGQYJ+jBhtskqwZjqEaah6+6azxh39MabGPmDw2CqKp+B+3WZBHnCFb4UuqFm7P6M8x5WoNCqDjaZBZuzsZlbE36nVlYjDdpEM7dYsBmksBb5H/xjrinHwknUUOswaCY8kHEbbw1uceIk3jWHqgX9vzFuR/CgzU5xbyTONTGqxdroY9g44rWZA+Tzmw20Ykj9KFVV7vvwpbqrH4q2Gx2mFZUlMQ30jojJeVLuk8rn1R9Dp/Btj9AN660E329Ur3XsrNzrNcqhA+gHaZHrdGF1sbX549r+rOYwKq9RqO/AptRCjdY1n9ITV8wp02ZchtY/AgwAM3YV79CKIEGAAAAAElFTkSuQmCC"},x8Bg:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJGQkE4RTNGNDE2NTExRTlBREMyQzM3QjE2QkFDODFCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJGQkE4RTQwNDE2NTExRTlBREMyQzM3QjE2QkFDODFCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkZCQThFM0Q0MTY1MTFFOUFEQzJDMzdCMTZCQUM4MUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkZCQThFM0U0MTY1MTFFOUFEQzJDMzdCMTZCQUM4MUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4PPbYiAAABIklEQVR42mI8c+YMAxbABsQBUGwJxFJA/AuInwDxeSBeD8QboWIogAWLYYFA3AXEKlgs0YDiSCC+A8TlQLwOWRETEpsZiDuhClQYCAOQmrVQPczYXNgGxGUMpAOYnnJkF4aQaRiyoSEwA0Fh089AOZgAMgtkYCgQy1DBQGkgDmOCJg1qgQCQgaZUNNAEFMsSyCLq6uoMPDw8ROn+8uULw82bN5GFJJmwpXZKAMiFz4GYFyaAZiOp4DnIhZeo6MAzIAM3UNHADSADV0NLEUrBU5BZsEgpooKBhUD8E5aXQa7spsCwbqgZKMVXJRBPIcOwqVC9GOXhXyDOhZYad4gw6A60HMiB6sVZYoMKzc1QxaDS2xia8WEBfxZaBazGlikAAgwA3vc6LEJJ7+0AAAAASUVORK5CYII="},y9lt:function(t,e,a){"use strict";var i=a("FyfS"),s=a.n(i),n=a("KzkL"),l={name:"follow-schedule-cell",components:{},props:{data:Object},data:function(){return{}},filters:{getRemindtypeText:function(t){switch(t){case 0:return"无";case 1:return"准时提醒";case 2:return"5分钟前";case 3:return"15分钟前";case 4:return"30分钟前";case 5:return"一个小时前";case 6:return"二个小时前";case 7:return"一天前";case 8:return"二天前";case 9:return"一周前"}return""}},computed:{},mounted:function(){},methods:{checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})}}},o=(a("0Ylm"),a("KHd+")),c=Object(o.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fl-c"},[i("flexbox",{staticClass:"fl-h"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.create_user_info,expression:"data.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(data.create_user_info.thumb_img)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),t._v(" "),i("div",{staticClass:"fl-h-b"},[i("div",{staticClass:"fl-h-name"},[t._v(t._s(t.data.create_user_info.realname))]),t._v(" "),i("div",{staticClass:"fl-h-time"},[t._v(t._s(t._f("filterTimestampToFormatTime")(t.data.create_time)))])]),t._v(" "),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD"}}),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]),t._v(" "),i("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")])],1)],1)],1),t._v(" "),i("div",{staticClass:"fl-b"},[i("div",[i("div",{staticClass:"state-color",style:{"background-color":t.data.color?t.data.color:"#fff"}}),t._v(t._s(t.data.title)+"\n    ")]),t._v(" "),i("div",{staticClass:"fl-b-des"},[i("flexbox",{staticClass:"fl-b-des-item"},[i("div",{staticClass:"fl-b-des-item-name"},[t._v("参与人：")]),t._v(" "),i("div",{staticClass:"owner-list"},t._l(t.data.ownerList,function(e,a){return i("span",{key:a},[i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[t._v(t._s(e.realname))])]),t._v(" "),i("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"k"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.thumb_img),expression:"$options.filters.filterUserLazyImg(k.thumb_img)",arg:"background-image"}],key:e.thumb_img,staticClass:"div-photo header-circle"})])],1)}))]),t._v(" "),i("flexbox",{staticClass:"fl-b-des-item"},[i("div",{staticClass:"fl-b-des-item-name"},[t._v("开始时间：")]),t._v(" "),i("div",[t._v(t._s(t._f("moment")(t.data.start_time,"YYYY-MM-DD HH:mm:ss")))])]),t._v(" "),i("flexbox",{staticClass:"fl-b-des-item"},[i("div",{staticClass:"fl-b-des-item-name"},[t._v("结束时间：")]),t._v(" "),i("div",[t._v(t._s(t._f("moment")(t.data.end_time,"YYYY-MM-DD HH:mm:ss")))])]),t._v(" "),i("flexbox",{staticClass:"fl-b-des-item"},[i("div",{staticClass:"fl-b-des-item-name"},[t._v("备注：")]),t._v(" "),i("div",[t._v(t._s(t.data.remark))])])],1),t._v(" "),t.data.contactsList.length>0||t.data.customerList.length>0||t.data.businessList.length>0||t.data.contractList.length>0?i("div",{staticClass:"related-business"},[i("div",{staticClass:"label"},[t._v("关联业务")]),t._v(" "),t._l(t.data.contactsList,function(e,s){return i("p",{key:"contacts"+s,on:{click:function(a){t.checkRelatedDetail("contacts",e)}}},[i("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n        联系人-"+t._s(e.name)+"\n      ")])}),t._v(" "),t._l(t.data.customerList,function(e,s){return i("p",{key:"customer"+s,on:{click:function(a){t.checkRelatedDetail("customer",e)}}},[i("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n        客户-"+t._s(e.name)+"\n      ")])}),t._v(" "),t._l(t.data.businessList,function(e,s){return i("p",{key:"business"+s,on:{click:function(a){t.checkRelatedDetail("business",e)}}},[i("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n        商机-"+t._s(e.name)+"\n      ")])}),t._v(" "),t._l(t.data.contractList,function(e,s){return i("p",{key:"contract"+s,on:{click:function(a){t.checkRelatedDetail("contract",e)}}},[i("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n        合同-"+t._s(e.name)+"\n      ")])})],2):t._e()])],1)},[],!1,null,"ba2a9f12",null);c.options.__file="FollowScheduleCell.vue";var r=c.exports,d=a("Dh/N"),u=a("BuGm"),m=(a("7Qib"),{name:"schedule-log",components:{FollowScheduleCell:r,CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-682f"),a.e("chunk-6f45"),a.e("chunk-a259"),a.e("chunk-1137")]).then(a.bind(null,"uMjE"))},CreateSchedule:u.default},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],showFullDetail:!1,detailCRMType:"",rowID:"",showDialog:!1,formData:{checkList:[]},newtext:""}},computed:{},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){e.scrollTop+e.clientHeight==e.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(n.h)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"event"}).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(t){var e=this;if("edit"==t.type){this.newText="编辑日程";var a=t.data.item;a.start_time=1e3*a.start_time,a.end_time=1e3*a.end_time,a.owner_user_ids=[];var i=!0,n=!1,l=void 0;try{for(var o,c=s()(a.ownerList);!(i=(o=c.next()).done);i=!0){var r=o.value;a.owner_user_ids.push(r.owner_id)}}catch(t){n=!0,l=t}finally{try{!i&&c.return&&c.return()}finally{if(n)throw l}}this.formData=a,this.showDialog=!0}else"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.b)({event_id:t.data.item.event_id}).then(function(t){e.refreshList(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"related-detail"==t.type&&(this.rowID=t.data.item[t.data.type+"_id"],this.detailCRMType=t.data.type,this.showFullDetail=!0)},onSubmit:function(t,e){this.refreshList(),"创建日程"==this.newText?(this.$message.success("新建成功"),this.showDialog=!1):(this.$message.success("编辑成功"),this.showDialog=!1)}}}),h=(a("AWHz"),Object(o.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,i){return a("follow-schedule-cell",{key:i,attrs:{data:e.dataInfo},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.showDialog?a("create-schedule",{attrs:{text:t.newText,formData:t.formData,appendToBody:!0},on:{onSubmit:t.onSubmit,closeDialog:function(e){t.showDialog=!1}}}):t._e()],1)},[],!1,null,"018bb388",null));h.options.__file="ScheduleLog.vue";e.a=h.exports},yNwx:function(t,e,a){"use strict";var i=a("6ZrO");a.n(i).a},yZyq:function(t,e,a){},z4Pn:function(t,e,a){"use strict";var i=a("etZQ");a.n(i).a},zDRf:function(t,e,a){},ze4I:function(t,e,a){"use strict";var i=a("d0PY");a.n(i).a}}]);