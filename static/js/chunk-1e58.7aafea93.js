(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1e58","chunk-5f59"],{"1iC6":function(e,t,i){"use strict";var s=i("nev6");i.n(s).a},"2y1U":function(e,t,i){},"36K6":function(e,t,i){"use strict";var s=i("2y1U");i.n(s).a},"3gs7":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAASCAYAAABSO15qAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjcxMEMyOTg1QzBBMzExRThCRjRERkU3Mzg5NDBDQTlCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjcxMEMyOTg2QzBBMzExRThCRjRERkU3Mzg5NDBDQTlCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NzEwQzI5ODNDMEEzMTFFOEJGNERGRTczODk0MENBOUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzEwQzI5ODRDMEEzMTFFOEJGNERGRTczODk0MENBOUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4G5F1NAAAA5UlEQVR42mJctWpVAwMDQyUQszGQBn4CcRMLkKgC4j9AfJZEA7SBuAZkwEUgNgTiTCA+TaRmJyDeA8SHmIBEERCD6NlAzEKEZj4gng/EH4E4EaTxMBAvB2J9IC4hwoB+IJYD4lQgvs8EFSwD4i9AXAfEKng0+wBxEhDPAOI1DFCng8BTIG4FYk6oJCMWzUJQb4LCrBAmyITmtNtA7AzE8VgMmA7EvEAcAcQ/sBnwE8nkDjTNnUAcBsRZQHwDWYIJTeFWKC2OJl4GpRehO4uJgUIwDAzAlnQ3UWqA/4B7gYEUbwEEGAANECY5RBCuPwAAAABJRU5ErkJggg=="},"5Mgy":function(e,t,i){"use strict";var s=i("w0hq");i.n(s).a},"6ZrO":function(e,t,i){},"9rzi":function(e,t,i){"use strict";var s=i("FLoD");i.n(s).a},FLoD:function(e,t,i){},JXju:function(e,t,i){"use strict";var s=i("7Qib"),n=i("mqlf"),a=i("ppJE"),l=i("PS1M"),o=i("n1dw"),c=i("xfX+"),r=i("8gwX"),u=i("K6D0"),d={name:"c-r-m-all-detail",components:{ClueDetail:n.a,CustomerDetail:a.a,ContactsDetail:l.a,BusinessDetail:o.a,ContractDetail:c.a,ProductDetail:r.a,MoneyDetail:u.a},watch:{crmType:function(e){"leads"==this.crmType?this.tabName="clue-detail":"customer"==this.crmType?this.tabName="customer-detail":"contacts"==this.crmType?this.tabName="contacts-detail":"business"==this.crmType?this.tabName="business-detail":"contract"==this.crmType?this.tabName="contract-detail":"product"==this.crmType?this.tabName="product-detail":"receivables"==this.crmType&&(this.tabName="money-detail")}},computed:{},data:function(){return{tabName:""}},props:{id:[String,Number],crmType:{type:String,default:""},visible:{type:Boolean,default:!1},listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.style.zIndex=Object(s.g)())},methods:{hiddenView:function(){this.$emit("update:visible",!1)}},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},m=(i("LARL"),i("KHd+")),f=Object(m.a)(d,function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.id&&e.visible?i(e.tabName,{tag:"component",staticClass:"d-view",attrs:{crmType:e.crmType,id:e.id,listenerIDs:e.listenerIDs,noListenerIDs:e.noListenerIDs},on:{"hide-view":e.hiddenView}}):e._e()},[],!1,null,"22ece621",null);f.options.__file="CRMAllDetail.vue";t.a=f.exports},LARL:function(e,t,i){"use strict";var s=i("MOLr");i.n(s).a},MOLr:function(e,t,i){},N0PQ:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZGRjBCRTYxRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZGRjBCRTYyRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkZGMEJFNUZFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkZGMEJFNjBFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz704RrgAAABwUlEQVR42uSXz0sCQRTH36h1sGNlaHjpVJoHC0KCOnVJOwSdqmM/6NZ/EF071rluQaduGQWd9BZEqWBhQQQmHYIQikDU6bs6G8Oy4q7sskYPPuzOzFu+++a9mZ1lnHNywlzkkDkm7JEb7/m8rWIDoVBHEc+DEuAaSmLMtqk+An6dfr8Ys0T4BHxJUbUzJq6q/yc47kR4CXg1fevgTcf3Faxp+vrAsuHikqxH054A5y2mWvYxnEaPwZTc/Kl1zJPJBt27gbR667YlnUjYMNWMORMxi8edETZhH+AZ9IIx4LZb+A5sieskGALfYMWW4hIFdQtmwJyIVt5gruEziucfrF5OVbAKZsGpzq42BVIQH+6suFovlRRQojnTzWethl73IO52wYaVEd+DcTDSaFUqRPV6c6RYJJ5ON8WJFqwuLkWl/7cWMhmE4SLm8xHP5YhFIkrEJPsYibhqQDgKCur3moXDROUy8Wy2KRoMqn5PZoQLBoSnxTf7otHyeonFYsSiUVlUsUMzwttAOfnV2my3e2ATvKjiFAjIPpdg30yOr0DYRL6VpbMDFoEPPIpz2EGrl2fyn0S3Hm8tNfbv/p1+BBgA+Vdv2Iz9D6cAAAAASUVORK5CYII="},NS7n:function(e,t,i){"use strict";var s={name:"filterContent",props:{obj:{default:{},required:!0}},watch:{obj:function(e){this.showObj=e}},computed:{},data:function(){return{optionsNames:{is:"等于",isnot:"不等于",contains:"包含",not_contain:"不包含",start_with:"开始于",end_with:"结束于",is_empty:"为空",is_not_empty:"不为空",eq:"等于",neq:"不等于",gt:"大于",egt:"大于等于",lt:"小于",elt:"小于等于"},showObj:{}}},mounted:function(){this.showObj=this.obj},methods:{handleDelete:function(e,t){this.$delete(this.showObj.obj,e.field),this.showObj.form.splice(t,1),this.$emit("delete",{item:e,index:t,obj:this.showObj})},getTypesName:function(e){return e.type_id&&e.typeOption.find(function(t){return t.type_id===e.type_id}).name||""},getStatusName:function(e){if(e.status_id){var t=e.statusOption.find(function(t){return t.status_id===e.status_id});return t.name?"-"+t.name:""}return""}}},n=(i("VzuG"),i("KHd+")),a=Object(n.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wrapper"},[i("ul",{staticClass:"list"},e._l(e.showObj.form,function(t,s){return i("li",{key:s,staticClass:"list-item"},["date"==t.form_type?i("span",[e._v(e._s(t.name+" “"+t.value[0]+"-"+t.value[1]+"”"))]):"datetime"===t.form_type?i("span",[e._v(e._s(t.name+" “"+t.value[0]+"-"+t.value[1]+"”"))]):"business_type"===t.form_type?i("span",[e._v(e._s(t.name+" “"+e.getTypesName(t)+e.getStatusName(t)+"”"))]):"user"===t.form_type?i("span",[e._v(e._s(t.name+" "+e.optionsNames[t.condition]+"“"+t.value[0].realname+"”"))]):i("span",[e._v(e._s(t.name+" "+e.optionsNames[t.condition]+"“"+t.value+"”"))]),e._v(" "),i("i",{staticClass:"el-icon-close icon",on:{click:function(i){e.handleDelete(t,s)}}})])}))])},[],!1,null,"778e696a",null);a.options.__file="filterContent.vue";t.a=a.exports},OPCT:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVENDNERTkxRTA5QjExRThBQkRDQjRERjVBMjY3MzE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVENDNERTkyRTA5QjExRThBQkRDQjRERjVBMjY3MzE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQ0M0RFOEZFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQ0M0RFOTBFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7c1/V2AAABIElEQVR42mL8//8/AwicPXuWgVxgbGwMZzMRUBsGxBeB+AXITigfL2DBIxcCxHlA7AnEz4CYB4gnQ+VW4dKEz4UNQBwNNQwEvgBxBhAn4XMhPgMFgPghmthPIP5NroF/cYgzkmsgMw7x/+Qa+AGIZbBEIgu5BjYC8VIgloLyQbE8E4gXkJtsVkMt3Ak1DOTiDiBeSa6BDFDNK0nJNdi8rArEa4H4IzQC0PFHqLwqMQaqA/ERID4IxIrQJIKOFaDyR6Dq8Xq5DYon4fHVe6g8J1RtMD4XugDxYiKDazYQu5GSbMgC6AbuAeJYIvWmAPEuQmFYDQ3w/1Cvv8dikCDU0mIgtifkwhtAbAdV+BBHsnkIlbeDqieYsG+ixxwpACDAAIZEQR7SM/O0AAAAAElFTkSuQmCC"},QJC7:function(e,t,i){"use strict";var s=i("7Qib"),n=i("KzkL"),a={name:"follow-record-cell",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-36de"),i.e("chunk-7a8c"),i.e("chunk-fd23"),i.e("chunk-5b32")]).then(i.bind(null,"uMjE"))}},props:{item:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},index:[String,Number]},data:function(){return{showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{},mounted:function(){},methods:{previewImg:function(e,t){this.$bus.emit("preview-image-bus",{index:t,data:e.map(function(e,t,i){return e.url=e.file_path,e})})},downloadFile:function(e){Object(s.a)({path:e.file_path,name:e.name})},handleCommand:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.j)({id:t.item.record_id}).then(function(i){t.$emit("on-handle",{type:e,data:{item:t.item,index:t.index}}),t.$message.success(i.data)}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},checkRelationDetail:function(e,t){this.relationID=t,this.relationCrmType=e,this.showFullDetail=!0}}},l=(i("36K6"),i("KHd+")),o=Object(l.a)(a,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fl-c"},[s("flexbox",{staticClass:"fl-h"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:e.item.create_user_info,expression:"item.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.item.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(item.create_user_info.thumb_img)",arg:"background-image"}],key:e.item.create_user_info.thumb_img,staticClass:"div-photo fl-h-img"}),e._v(" "),s("div",{staticClass:"fl-h-b"},[s("div",{staticClass:"fl-h-name"},[e._v(e._s(e.item.create_user_info.realname))]),e._v(" "),s("div",{staticClass:"fl-h-time"},[e._v(e._s(e._f("filterTimestampToFormatTime")(e.item.create_time,"YYYY-MM-DD HH:mm")))])]),e._v(" "),s("flexbox",{staticClass:"fl-h-mark"},[s("img",{staticClass:"fl-h-mark-img",attrs:{src:i("N0PQ")}}),e._v(" "),s("div",{staticClass:"fl-h-mark-name"},[e._v("跟进记录")])]),e._v(" "),s("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[s("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD","margin-left":"8px"}}),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"delete"}},[e._v("删除")])],1)],1)],1),e._v(" "),s("div",{staticClass:"fl-b"},[s("div",{staticClass:"fl-b-content"},[e._v(e._s(e.item.content))]),e._v(" "),e.item.dataInfo.imgList&&e.item.dataInfo.imgList.length>0?s("flexbox",{staticClass:"fl-b-images",attrs:{wrap:"wrap"}},e._l(e.item.dataInfo.imgList,function(t,i){return s("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:t.file_path_thumb,expression:"file.file_path_thumb",arg:"background-image"}],key:t.file_path_thumb,staticClass:"fl-b-img-item",on:{click:function(t){e.previewImg(e.item.dataInfo.imgList,i)}}})})):e._e(),e._v(" "),e.item.dataInfo.fileList&&e.item.dataInfo.fileList.length>0?s("div",{staticClass:"fl-b-files"},e._l(e.item.dataInfo.fileList,function(t,n){return s("flexbox",{key:n,staticClass:"cell"},[s("img",{staticClass:"cell-head",attrs:{src:i("6KEE")}}),e._v(" "),s("div",{staticClass:"cell-body"},[e._v(e._s(t.name)),s("span",{staticStyle:{color:"#ccc"}},[e._v("（"+e._s(t.size)+"）")])]),e._v(" "),s("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(i){e.downloadFile(t)}}},[e._v("下载")])],1)})):e._e(),e._v(" "),e.item.category||e.item.next_time?s("div",{staticClass:"follow"},[e.item.category?s("span",{staticClass:"follow-info"},[e._v(e._s(e.item.category))]):e._e(),e._v(" "),e.item.next_time?s("span",{staticClass:"follow-info"},[e._v(e._s(e._f("filterTimestampToFormatTime")(e.item.next_time,"YYYY-MM-DD HH:mm:ss")))]):e._e()]):e._e(),e._v(" "),e.item.dataInfo.contactsList&&e.item.dataInfo.contactsList.length>0?s("div",{staticClass:"fl-b-other"},[s("div",{staticClass:"fl-b-other-name"},[e._v("关联联系人")]),e._v(" "),s("div",e._l(e.item.dataInfo.contactsList,function(t,i){return s("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){e.checkRelationDetail("contacts",t.contacts_id)}}},[s("i",{staticClass:"wukong wukong-contacts cell-head crm-type",style:{opacity:0==i?1:0}}),e._v(" "),s("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[e._v(e._s(t.name))])])}))]):e._e(),e._v(" "),e.item.dataInfo.businessList&&e.item.dataInfo.businessList.length>0?s("div",{staticClass:"fl-b-other"},[s("div",{staticClass:"fl-b-other-name"},[e._v("关联商机")]),e._v(" "),s("div",e._l(e.item.dataInfo.businessList,function(t,i){return s("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){e.checkRelationDetail("business",t.business_id)}}},[s("i",{staticClass:"wukong wukong-business cell-head crm-type",style:{opacity:0==i?1:0}}),e._v(" "),s("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[e._v(e._s(t.name))])])}))]):e._e()],1),e._v(" "),s("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,crmType:e.relationCrmType,id:e.relationID},on:{"update:visible":function(t){e.showFullDetail=t}}})],1)},[],!1,null,"2cb1ea51",null);o.options.__file="FollowRecordCell.vue";var c={name:"record-log",components:{FollowRecordCell:o.exports},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(e){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},mounted:function(){var e=this;this.$bus.on("follow-log-refresh",function(t){"record-log"==t.type&&e.refreshList()});var t=this,i=document.getElementById("follow-log-content");i.onscroll=function(){i.scrollTop+i.clientHeight==i.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0,Object(n.k)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"record"}).then(function(t){e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},cellHandle:function(e){"delete"==e.type&&this.list.splice(e.data.index,1)}},beforeDestroy:function(){this.$bus.off("follow-log-refresh")}},r=(i("9rzi"),Object(l.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,s){return i("follow-record-cell",{key:s,attrs:{item:t,crmType:e.crmType,index:s},on:{"on-handle":e.cellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{type:"text",loading:e.loadMoreLoading}},[e._v(e._s(e.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)])])},[],!1,null,"7facfbc0",null));r.options.__file="RecordLog.vue";t.a=r.exports},"RU/L":function(e,t,i){i("Rqdy");var s=i("WEpk").Object;e.exports=function(e,t,i){return s.defineProperty(e,t,i)}},Rqdy:function(e,t,i){var s=i("Y7ZC");s(s.S+s.F*!i("jmDH"),"Object",{defineProperty:i("2faE").f})},SEkw:function(e,t,i){e.exports={default:i("RU/L"),__esModule:!0}},UEWd:function(e,t,i){"use strict";var s=i("7Qib"),n=i("KTTK"),a={name:"mix-add",components:{CrmRelative:i("mkuN").a},props:{showRelativeBusiness:{type:Boolean,default:!1},showRelativeContacts:{type:Boolean,default:!1},id:[String,Number],crmType:{type:String,default:""}},data:function(){return{content:"",inputAutosize:{minRows:1,maxRows:6},barItems:[{img:i("S1Xc"),title:"图片",type:"img",data:"image/*"},{img:i("rl4O"),title:"附件",type:"file",data:"*.*"}],imgFiles:[],files:[],business:[],contacts:[],showRelativeType:""}},computed:{},mounted:function(){this.showRelativeBusiness&&this.barItems.push({img:i("i91G"),title:"关联商机",type:"business",show:!1}),this.showRelativeContacts&&this.barItems.push({img:i("OPCT"),title:"关联联系人",type:"contacts",show:!1}),this.$on("submit-info",function(){this.$emit("mixadd-info",{content:this.content,files:this.files,images:this.imgFiles,business:this.business,contacts:this.contacts})})},methods:{resetInfo:function(){this.content="",this.imgFiles=[],this.files=[],this.business=[],this.contacts=[],this.showRelativeType=""},checkRelativeInfos:function(e){"business"==this.showRelativeType?this.business=e.data:"contacts"==this.showRelativeType&&(this.contacts=e.data)},barClick:function(e){"business"==e.type?(this.showRelativeType=e.type,e.show=!0):"contacts"==e.type&&(this.showRelativeType=e.type,e.show=!0)},uploadFile:function(e){for(var t=this,i=e.target.files,a=this,l=function(l){var o=i[l];(c={}).module_id=t.id,c.module="crm_"+t.crmType,"image/*"==e.target.accept?c["img[]"]=o:"*.*"==e.target.accept&&(c["file[]"]=o),Object(n.e)(c).then(function(t){t.data.forEach(function(t,i){t.size=Object(s.c)(o.size),"image/*"==e.target.accept?a.imgFiles.push(t):"*.*"==e.target.accept&&(t.icon=Object(s.f)(o),a.files.push(t))})}).catch(function(){})},o=0;o<i.length;o++){var c;l(o)}e.target.value=""},deleteAllImg:function(){this.imgFiles=[]},deleteImgOrFile:function(e,t,i){var s=this;Object(n.c)({save_name:t.save_name,module_id:this.id,module:"crm_"+this.crmType}).then(function(t){"image"==e?s.imgFiles.splice(i,1):s.files.splice(i,1),s.$message.success(t.data)}).catch(function(){})},mouseImgOver:function(e,t){e.showDelete=!0,this.$set(this.imgFiles,t,e)},mouseImgLeave:function(e,t){e.showDelete=!1,this.$set(this.imgFiles,t,e)},inputFocus:function(){var e=this;this.inputAutosize={minRows:3,maxRows:6},this.$nextTick(function(){e.$refs.textarea.resizeTextarea()})}},beforeDestroy:function(){this.$off("submit-info")}},l=(i("yNwx"),i("KHd+")),o=Object(l.a)(a,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mix-container"},[s("div",{staticClass:"i-cont"},[s("el-input",{ref:"textarea",attrs:{type:"textarea",autosize:e.inputAutosize,clearable:"",resize:"none",placeholder:"请输入内容"},on:{focus:e.inputFocus},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),e._v(" "),e.imgFiles.length>0?s("section",{staticClass:"img-cont"},[s("flexbox",{attrs:{wrap:"wrap"}},[e._l(e.imgFiles,function(t,i){return s("div",{key:i,staticClass:"img-item",style:{"background-image":"url("+t.path+")"},on:{mouseover:function(s){e.mouseImgOver(t,i)},mouseleave:function(s){e.mouseImgLeave(t,i)}}},[t.showDelete?s("div",{staticClass:"img-delete",on:{click:function(s){e.deleteImgOrFile("image",t,i)}}},[e._v("×")]):e._e()])}),e._v(" "),s("div",{staticClass:"img-item-add"},[s("input",{staticClass:"img-item-iput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:e.uploadFile}})])],2),e._v(" "),s("div",{staticClass:"img-bar",on:{click:e.deleteAllImg}},[e._v("全部删除")])],1):e._e(),e._v(" "),e.files.length>0?s("section",{staticClass:"file-cont"},[s("flexbox",{staticClass:"f-header"},[s("img",{staticClass:"f-logo",attrs:{src:i("rl4O")}}),e._v(" "),s("div",{staticClass:"f-name"},[e._v("附件")])]),e._v(" "),s("div",{staticClass:"f-body"},e._l(e.files,function(t,i){return s("flexbox",{key:i,staticClass:"f-item"},[s("img",{staticClass:"f-img",attrs:{src:t.icon}}),e._v(" "),s("div",{staticClass:"f-name"},[e._v(e._s(t.name+"("+t.size+")"))]),e._v(" "),s("div",{staticClass:"close-button",on:{click:function(s){e.deleteImgOrFile("file",t,i)}}},[e._v("×")])])})),e._v(" "),s("div",{staticClass:"img-bar",on:{click:function(t){e.files=[]}}},[e._v("全部删除")])],1):e._e(),e._v(" "),e.business.length>0?s("section",{staticClass:"c-cont"},[s("flexbox",{staticClass:"c-header"},[s("img",{staticClass:"c-logo",attrs:{src:i("i91G")}}),e._v(" "),s("div",{staticClass:"c-name"},[e._v("商机")])]),e._v(" "),s("div",{staticClass:"c-body"},[s("flexbox",{attrs:{wrap:"wrap"}},e._l(e.business,function(t,i){return s("flexbox",{key:i,staticClass:"c-item"},[s("div",{staticClass:"c-item-name"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"c-item-close",on:{click:function(t){e.business.splice(i,1)}}},[e._v("×")])])}))],1)],1):e._e(),e._v(" "),e.contacts.length>0?s("section",{staticClass:"c-cont"},[s("flexbox",{staticClass:"c-header"},[s("img",{staticClass:"c-logo",attrs:{src:i("OPCT")}}),e._v(" "),s("div",{staticClass:"c-name"},[e._v("联系人")])]),e._v(" "),s("div",{staticClass:"c-body"},[s("flexbox",{attrs:{wrap:"wrap"}},e._l(e.contacts,function(t,i){return s("flexbox",{key:i,staticClass:"c-item"},[s("div",{staticClass:"c-item-name"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"c-item-close",on:{click:function(t){e.contacts.splice(i,1)}}},[e._v("×")])])}))],1)],1):e._e(),e._v(" "),s("flexbox",{staticClass:"bar-cont"},[e._l(e.barItems,function(t,i){return["img"==t.type||"file"==t.type?s("flexbox",{key:i,staticClass:"bar-item",nativeOn:{click:function(i){e.barClick(t)}}},[s("input",{staticClass:"bar-input",attrs:{type:"file",accept:t.data,multiple:""},on:{change:e.uploadFile}}),e._v(" "),s("img",{staticClass:"bar-img",attrs:{src:t.img}}),e._v(" "),s("div",{staticClass:"bar-title"},[e._v(e._s(t.title))])]):s("el-popover",{key:i,attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.show,callback:function(i){e.$set(t,"show",i)},expression:"item.show"}},[s("crm-relative",{ref:"crmrelative",refInFor:!0,attrs:{show:t.show,radio:!1,action:{type:"condition",data:{form_type:"customer",customer_id:e.id}},selectedData:"business"==t.type?{business:e.business}:{contacts:e.contacts},"crm-type":t.type},on:{close:function(e){t.show=!1},changeCheckout:e.checkRelativeInfos}}),e._v(" "),s("flexbox",{staticClass:"bar-item",attrs:{slot:"reference"},nativeOn:{click:function(i){e.barClick(t)}},slot:"reference"},[s("img",{staticClass:"bar-img",attrs:{src:t.img}}),e._v(" "),s("div",{staticClass:"bar-title"},[e._v(e._s(t.title))])])],1)]})],2)],1)},[],!1,null,"72849f50",null);o.options.__file="MixAdd.vue";t.a=o.exports},VzuG:function(e,t,i){"use strict";var s=i("eVVl");i.n(s).a},YEIV:function(e,t,i){"use strict";t.__esModule=!0;var s=function(e){return e&&e.__esModule?e:{default:e}}(i("SEkw"));t.default=function(e,t,i){return t in e?(0,s.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},eVVl:function(e,t,i){},g7Kh:function(e,t,i){},i68b:function(e,t,i){"use strict";var s=i("KzkL");t.a={data:function(){return{followTypes:[],followType:""}},created:function(){this.getFollowLogType()},methods:{getFollowLogType:function(){var e=this;this.loading=!0,Object(s.s)().then(function(t){e.loading=!1,e.followTypes=t.data.map(function(e){return{type:e,name:e}}),e.followType=t.data.length>0?t.data[0]:""}).catch(function(){e.loading=!1})}},deactivated:function(){}}},i91G:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU2RjI0NjM0RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU2RjI0NjM1RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTZGMjQ2MzJFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTZGMjQ2MzNFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4H2LzoAAAAnklEQVR42mI8c+YMA7WAsbExAxMDlQGygSuA+B8Q/8eD/0HV4QQsSOwwNAtwAZChEcS4kJFIXzES62WqhyFdDESOqH1ocjuwRRQLAQPxRZQHEvsvLKKYKIkAbD5FNvA/kZr/ExuGq5HC6wiauo1I4bWa2IQdDsXYgP+gTTZUN5DYiPpHbDqERRQjAUtXE2sgvojCnnD///8/uCMFIMAAVWsql9WKpTgAAAAASUVORK5CYII="},nev6:function(e,t,i){},oWS4:function(e,t,i){"use strict";var s=i("7Qib"),n={name:"index",components:{XhUserCell:i("8GhS").p},props:{dialogVisible:{type:Boolean,required:!0,default:!1},fieldList:{type:Array,required:!0,default:[]},obj:{default:{},required:!0},isSeas:{type:Boolean,default:!1},crmType:{type:String,default:""}},data:function(){return{form:[],visible:!1,showErrors:!1,saveChecked:!1,saveDefault:!1,saveName:null}},watch:{dialogVisible:{handler:function(e){e&&(this.form=Object(s.h)(this.obj.form),0==this.form.length&&this.form.push({field:"",name:"",form_type:"",condition:"is",value:"",typeOption:[],statusOption:[],type_id:"",status_id:""}),this.saveChecked=!1,this.saveDefault=!1,this.saveName=null),this.visible=this.dialogVisible},deep:!0,immediate:!0}},methods:{typeOptionsChange:function(e){if(e.type_id){var t=e.typeOption.find(function(t){return t.type_id===e.type_id});e.statusOption=t.statusList||[]}else e.statusOption=[];e.status_id=""},userValueChange:function(e){e.value.length>0?e.item.value=e.value:e.item.value=[]},calConditionOptions:function(e,t){return"select"==e||"checkbox"==e||"user"==e?[{value:"is",label:"等于",disabled:!1},{value:"isnot",label:"不等于",disabled:!1}]:"module"==e||"text"==e||"textarea"==e?[{value:"is",label:"等于",disabled:!1},{value:"isnot",label:"不等于",disabled:!1},{value:"contains",label:"包含",disabled:!1},{value:"not_contain",label:"不包含",disabled:!1}]:"floatnumber"==e||"number"==e?[{value:"is",label:"等于",disabled:!1},{value:"isnot",label:"不等于",disabled:!1},{value:"contains",label:"包含",disabled:!1},{value:"not_contain",label:"不包含",disabled:!1},{value:"is_empty",label:"为空",disabled:!1},{value:"is_not_empty",label:"不为空",disabled:!1},{value:"gt",label:"大于",disabled:!1},{value:"egt",label:"大于等于",disabled:!1},{value:"lt",label:"小于",disabled:!1},{value:"elt",label:"小于等于",disabled:!1}]:"category"==e?[{value:"is",label:"等于",disabled:!1},{value:"isnot",label:"不等于",disabled:!1},{value:"contains",label:"包含",disabled:!1},{value:"not_contain",label:"不包含",disabled:!1}]:[{value:"is",label:"等于",disabled:!1},{value:"isnot",label:"不等于",disabled:!1},{value:"contains",label:"包含",disabled:!1},{value:"not_contain",label:"不包含",disabled:!1},{value:"start_with",label:"开始于",disabled:!1},{value:"end_with",label:"结束于",disabled:!1},{value:"is_empty",label:"为空",disabled:!1},{value:"is_not_empty",label:"不为空",disabled:!1},{value:"gt",label:"大于",disabled:!1},{value:"egt",label:"大于等于",disabled:!1},{value:"lt",label:"小于",disabled:!1},{value:"elt",label:"小于等于",disabled:!1}]},fieldChange:function(e){var t=this.fieldList.find(function(t){return t.field===e.field});t&&(e.form_type=t.form_type,e.name=t.name,"business_type"==e.form_type?(e.typeOption=t.setting,e.statusOption=[],e.type_id="",e.status_id=""):"select"==e.form_type?e.setting=t.setting||[]:"date"!==e.form_type&&"datetime"!==e.form_type&&"user"!==e.form_type||(e.value=[])),this.form.filter(function(t){return t.field===e.field}).length>1?this.showErrors=!0:this.showErrors=!1},handleCancel:function(){this.$emit("update:dialogVisible",!1)},handleConfirm:function(){if(this.showErrors)this.$message.error("筛选条件中有重复项！");else if(!this.saveChecked||this.saveName&&""!==this.saveName){for(var e=0;e<this.form.length;e++){var t=this.form[e];if(!t.field||""===t.field)return void this.$message.error("要筛选的字段名称不能为空！");if("business_type"==t.form_type){if(!t.type_id&&!t.status_id)return void this.$message.error("请输入筛选条件的值！")}else if("date"==t.form_type||"datetime"==t.form_type||"user"==t.form_type){if(!t.value||0===t.value.length)return void this.$message.error("请输入筛选条件的值！")}else if(!t.value)return void this.$message.error("请输入筛选条件的值！")}var i={};this.form.forEach(function(e){"date"==e.form_type?i[e.field]={start_date:e.value[0],end_date:e.value[1],form_type:e.form_type,name:e.name}:"datetime"==e.form_type?i[e.field]={start:Object(s.d)(e.value[0]),end:Object(s.d)(e.value[1]),form_type:e.form_type,name:e.name}:"business_type"==e.form_type?i[e.field]={type_id:e.type_id,status_id:e.status_id,form_type:e.form_type,name:e.name}:"user"==e.form_type?i[e.field]={condition:e.condition,value:e.value[0].id,form_type:e.form_type,name:e.name}:i[e.field]={condition:e.condition,value:e.value,form_type:e.form_type,name:e.name}});var n={obj:i,form:this.form,saveChecked:this.saveChecked,saveDefault:this.saveDefault,saveName:this.saveName};this.$emit("filter",n)}else this.$message.error("场景名称不能为空！")},handleAdd:function(){this.form.push({field:"",condition:"is",value:"",form_type:"",setting:[],typeOption:[],statusOption:[],type_id:"",status_id:""})},handleDelete:function(e){var t=this;this.$confirm("您确定要删除这一条数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.form.splice(e,1)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},a=(i("1iC6"),i("KHd+")),l=Object(a.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"高级筛选",visible:e.visible,width:"800px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[i("div",{staticStyle:{"margin-bottom":"10px"}},[e._v("筛选条件")]),e._v(" "),i("el-form",{staticClass:"filter-container"},[i("el-form-item",[e._l(e.form,function(t,s){return[i("el-row",{key:s},[i("el-col",{attrs:{span:8}},[i("el-select",{attrs:{placeholder:"请选择要筛选的字段名"},on:{change:function(i){e.fieldChange(t)}},model:{value:t.field,callback:function(i){e.$set(t,"field",i)},expression:"formItem.field"}},e._l(e.fieldList,function(e){return i("el-option",{key:e.field,attrs:{label:e.name,value:e.field}})}))],1),e._v(" "),"date"!==t.form_type&&"datetime"!==t.form_type&&"business_type"!==t.form_type?i("el-col",{attrs:{span:1}},[e._v(" ")]):e._e(),e._v(" "),"date"!==t.form_type&&"datetime"!==t.form_type&&"business_type"!==t.form_type?i("el-col",{attrs:{span:4}},[i("el-select",{attrs:{placeholder:"请选择范围"},model:{value:t.condition,callback:function(i){e.$set(t,"condition",i)},expression:"formItem.condition"}},e._l(e.calConditionOptions(t.form_type,t),function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(" "),"business_type"==t.form_type?i("el-col",{attrs:{span:1}},[e._v(" ")]):e._e(),e._v(" "),"business_type"==t.form_type?i("el-col",{attrs:{span:4}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:function(i){e.typeOptionsChange(t)}},model:{value:t.type_id,callback:function(i){e.$set(t,"type_id",i)},expression:"formItem.type_id"}},e._l(t.typeOption,function(e){return i("el-option",{key:e.type_id,attrs:{label:e.name,value:e.type_id}})}))],1):e._e(),e._v(" "),i("el-col",{attrs:{span:1}},[e._v(" ")]),e._v(" "),i("el-col",{attrs:{span:"datetime"===t.form_type||"date"===t.form_type?13:8}},["select"===t.form_type?i("el-select",{attrs:{placeholder:"请选择筛选条件"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}},e._l(t.setting,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})):"date"===t.form_type||"datetime"===t.form_type?i("el-date-picker",{staticStyle:{padding:"0px 10px"},attrs:{"value-format":"date"===t.form_type?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",type:"date"===t.form_type?"daterange":"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}}):"business_type"===t.form_type?i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.status_id,callback:function(i){e.$set(t,"status_id",i)},expression:"formItem.status_id"}},e._l(t.statusOption,function(e){return i("el-option",{key:e.status_id,attrs:{label:e.name,value:e.status_id}})})):"user"===t.form_type?i("xh-user-cell",{attrs:{item:t,infoParams:{m:"crm",c:e.crmType,a:"index"}},on:{"value-change":e.userValueChange}}):i("el-input",{attrs:{placeholder:"请输入筛选条件"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}})],1),e._v(" "),i("el-col",{staticClass:"delete",attrs:{span:1}},[i("i",{staticClass:"el-icon-error delete-btn",on:{click:function(t){e.handleDelete(s)}}})])],1)]})],2)],1),e._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:e.showErrors,expression:"showErrors"}],staticClass:"el-icon-warning warning-info"},[i("span",{staticClass:"desc"},[e._v("筛选条件中有重复项！")])]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.handleAdd}},[e._v("+ 添加筛选条件")]),e._v(" "),e.isSeas?e._e():i("div",{staticClass:"save"},[i("el-checkbox",{model:{value:e.saveChecked,callback:function(t){e.saveChecked=t},expression:"saveChecked"}},[e._v("保存为场景")]),e._v(" "),i("el-input",{directives:[{name:"show",rawName:"v-show",value:e.saveChecked,expression:"saveChecked"}],staticClass:"name",attrs:{maxlength:10,placeholder:"请输入场景名称，最多10个字符"},model:{value:e.saveName,callback:function(t){e.saveName="string"==typeof t?t.trim():t},expression:"saveName"}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.saveChecked,expression:"saveChecked"}],staticClass:"save-setting"},[i("el-checkbox",{model:{value:e.saveDefault,callback:function(t){e.saveDefault=t},expression:"saveDefault"}},[e._v("设置为默认")])],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 定")])],1)],1)},[],!1,null,"61545102",null);l.options.__file="index.vue";t.a=l.exports},rl4O:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUzM0EzN0E0RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUzM0EzN0E1RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTMzQTM3QTJFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTMzQTM3QTNFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7neeY0AAABL0lEQVR42syUv0tCURSA1Vzam5ya+h8ag5DG3GpqqsAiwVFoECJc+jGpCFZrLTpFUjQ7PPwjClxyiCY3+y6cB5fLud0rOXjhG965j++de865L5skSWaRK5dZ8JpHmIUG/MAA1v4jNLIWVKAO6/CmSWOFO3AAJbiCLVjVpLHCV9iAF3ke+6S5wDFr8Az78Ons29LHkNDImnAO3/AAZeU9I+3AZhrI/9EAU7Nd6egIbuEJJk5tL2RPzVCTpfGZ0qieZF/TMvTJzmT+TqzsbFnZ/pidYUORHcKNzF87JHMzPJXUB1ZsBY6gGyNzhUM4lhEYS6ztqZkqc4+8B1N4h4LSgH5I5gq/YFuRprL7kEwbm4kjrYrsLkbmuymp9AMu4VpGZhZz6fOeuJEWl+KP/SvAAHR5UyjSji44AAAAAElFTkSuQmCC"},tcal:function(e,t,i){"use strict";var s=i("g7Kh");i.n(s).a},w0hq:function(e,t,i){},xQxM:function(e,t,i){"use strict";i.r(t);var s=i("QbLZ"),n=i.n(s),a=i("GQeE"),l=i.n(a),o=i("KzkL"),c=i("5tgW"),r=i("vG5h"),u=i("YEIV"),d=i.n(u),m=i("QHZi"),f=i("7Qib"),p=i("wd/R"),h=i.n(p),v=d()({components:{},data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-300,list:[],fieldList:[],currentPage:1,pageSize:15,pageSizes:[15,30,45,60],total:0,formatterRules:{}}},mounted:function(){var e=this;this.$bus.on("message-scroll",function(t){e.tableHeight=t})},beforeDestroy:function(){this.$bus.off("message-scroll")},methods:{handleRowClick:function(e,t,i){"leads"===this.crmType?(this.rowID=e.leads_id,this.rowType="leads",this.showDview=!0):"customer"===this.crmType?(this.rowID=e.customer_id,this.rowType="customer",this.showDview=!0):"contacts"===this.crmType?("customer_id"===t.property?(this.rowID=e.customer_id_info.customer_id,this.rowType="customer"):(this.rowID=e.contacts_id,this.rowType="contacts"),this.showDview=!0):"business"===this.crmType?("customer_id"===t.property?(this.rowID=e.customer_id_info.customer_id,this.rowType="customer"):(this.rowID=e.business_id,this.rowType="business"),this.showDview=!0):"contract"===this.crmType?("customer_id"===t.property?(this.rowID=e.customer_id_info.customer_id,this.rowType="customer"):"business_id"===t.property?(this.rowID=e.business_id_info.business_id,this.rowType="business"):"contacts_id"===t.property?(this.rowID=e.contacts_id_info.contacts_id,this.rowType="contacts"):(this.rowID=e.contract_id,this.rowType="contract"),this.showDview=!0):"product"===this.crmType?(this.rowID=e.product_id,this.showDview=!0):"receivables"===this.crmType?("customer_id"===t.property?(this.rowID=e.customer_id_info.customer_id,this.rowType="customer"):"contract_id"===t.property?(this.rowID=e.contract_id,this.rowType="contract"):(this.rowID=e.receivables_id,this.rowType="receivables"),this.showDview=!0):"receivables_plan"===this.crmType&&("customer_id"===t.property?(this.rowID=e.customer_id_info.customer_id,this.rowType="customer",this.showDview=!0):"contract_id"===t.property&&(this.rowID=e.contract_id,this.rowType="contract",this.showDview=!0))},getList:function(){var e=this;this.loading=!0;var t=this.getIndexRequest(),i={page:this.currentPage,limit:this.pageSize,types:"list",type:this.optionsType,isSub:this.isSubType};for(var s in this.filterObj.obj)i[s]=this.filterObj.obj[s];t(i).then(function(t){e.list=t.data.list,e.total=t.data.dataCount,e.loading=!1}).catch(function(){e.loading=!1})},getIndexRequest:function(){return{todayCustomer:m.h,followLeads:m.g,followCustomer:m.f,checkContract:m.d,checkReceivables:m.e,remindReceivablesPlan:m.c,endContract:m.a}[this.infoType]},getFieldList:function(){var e=this;if("receivables_plan"!=this.crmType)Object(o.v)({types:"crm_"+this.crmType,module:"crm",controller:this.crmType,action:"index"}).then(function(t){e.handelFieldList(t.data)}).catch(function(){e.loading=!1});else{this.handelFieldList([{field:"num",form_type:"text",name:"期数"},{field:"customer_id",form_type:"customer_id",name:"客户名称"},{field:"contract_id",form_type:"contract_id",name:"合同编号"},{field:"money",form_type:"text",name:"计划回款金额"},{field:"return_date",form_type:"text",name:"计划回款日期"},{field:"return_type",form_type:"text",name:"计划回款方式"},{field:"remind",form_type:"text",name:"提前几日提醒"},{prop:"remark",form_type:"text",name:"备注"}])}},handelFieldList:function(e){for(var t=0;t<e.length;t++){var i=e[t];if("date"===i.form_type){this.formatterRules[i.field]={formatter:function(e){return"0000-00-00"==e&&(e=""),e}}}else if("datetime"===i.form_type){this.formatterRules[i.field]={formatter:function(e){return 0!=e&&e?h()(Object(f.e)(e)).format("YYYY-MM-DD HH:mm:ss"):""}}}else if("create_user_id"===i.field||"owner_user_id"===i.field){this.formatterRules[i.field]={type:"crm",formatter:function(e){return e?e.realname:""}}}else if("user"===i.form_type){this.formatterRules[i.field]={type:"crm",formatter:function(e){if(e){for(var t="",i=0;i<e.length;i++)t=t+e[i].realname+(i===e.length-1?"":",");return t}return""}}}else if("structure"===i.form_type){this.formatterRules[i.field]={type:"crm",formatter:function(e){if(e){for(var t="",i=0;i<e.length;i++)t=t+e[i].name+(i===e.length-1?"":",");return t}return""}}}else if("contacts_id"===i.field||"customer_id"===i.field||"business_id"===i.field||"contract_id"===i.field){this.formatterRules[i.field]={type:"crm",formatter:function(e){return e?e.name:""}}}else if("status_id"===i.field||"type_id"===i.field||"category_id"===i.field){this.formatterRules[i.field]={type:"crm",formatter:function(e){return e||""}}}var s=0;s=i.width?i.width:i.name&&i.name.length<=6?15*i.name.length+45:140,this.fieldList.push({prop:i.field,label:i.name,width:s})}this.getList()},fieldFormatter:function(e,t){var i=this.formatterRules[t.property];return i?"crm"===i.type?t.property?i.formatter(e[t.property+"_info"])||"--":"":i.formatter(e[t.property])||"--":e[t.property]||"--"},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getStatusStyle:function(e){return 0==e?{"border-color":"#E6A23C","background-color":"#FDF6EC",color:"#E6A23C"}:1==e?{"border-color":"#409EFF","background-color":"#ECF5FF",color:"#409EFF"}:2==e?{"border-color":"#67C23A","background-color":"#F0F9EB",color:"#67C23A"}:3==e?{"border-color":"#F56C6B","background-color":"#FEF0F0",color:"#F56C6B"}:4==e?{"background-color":"#FFFFFF"}:void 0}}},"beforeDestroy",function(){document.getElementById("crm-table")&&document.getElementById("crm-table").removeEventListener("click",function(e){e.stopPropagation()})}),b=i("oWS4"),y=i("NS7n"),g=i("JXju"),_={name:"c-r-m-message",components:{filterForm:b.a,filterContent:y.a,CRMAllDetail:g.a},mixins:[v],watch:{show:function(){this.initTableHead()}},props:{crmType:{type:String,default:""},infoType:{type:String,default:""},infoTitle:{type:String,default:""},infoTips:{type:String,default:""},show:Boolean},data:function(){return{optionsType:0,isSubType:0,showFilter:!1,filterFieldList:[],filterObj:{form:[]},selectionList:[],selectionButtonList:[{name:"已跟进",type:"follow",icon:i("aQEv")}],rowID:"",rowType:"",showDview:!1}},computed:{showSelection:function(){return"followLeads"==this.infoType||"followCustomer"==this.infoType},showFilterView:function(){return"receivables_plan"!=this.crmType},showCheckStatus:function(){return"contract"==this.crmType||"receivables"==this.crmType},options:function(){return"todayCustomer"==this.infoType?[{name:"今日需联系",value:1},{name:"已逾期",value:2},{name:"已联系",value:3}]:"followLeads"==this.infoType||"followCustomer"==this.infoType?[{name:"待跟进",value:1},{name:"已跟进",value:2}]:"checkContract"==this.infoType||"checkReceivables"==this.infoType?[{name:"待审核",value:1},{name:"已审核",value:2}]:"remindReceivablesPlan"==this.infoType?[{name:"待回款",value:1},{name:"已回款",value:2},{name:"已逾期",value:3}]:"endContract"==this.infoType?[{name:"即将到期",value:1},{name:"已到期",value:2}]:[]}},mounted:function(){this.options.length>0&&(this.optionsType=this.options[0].value),this.initTableHead()},methods:{initTableHead:function(){this.show&&0==this.fieldList.length&&this.getFieldList()},refreshList:function(){this.currentPage=1,this.fieldList.length>0?this.getList():this.getFieldList()},handleSelectionChange:function(e){this.selectionList=e},selectionBarClick:function(e){var t=this;"follow"==e&&this.$confirm("您确定此操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(0,{followLeads:c.h,followCustomer:r.n}[t.infoType])({id:t.selectionList.map(function(e){return e[t.crmType+"_id"]})}).then(function(e){t.$message.success(e.data),t.refreshList(),t.$emit("on-handle",{type:"follow",value:t.selectionList.length,infoType:t.infoType})}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},getFilterFieldInfo:function(){var e=this;Object(o.x)({types:"crm_"+this.crmType}).then(function(t){e.filterFieldList=t.data,e.showFilter=!0}).catch(function(){})},handleFilter:function(e){this.filterObj=e,this.showFilter=!1,this.refreshList()},handleDeleteField:function(e){this.filterObj=e.obj;var t=document.documentElement.clientHeight,i=l()(this.filterObj).length>0?310:240;this.tableHeight=t-i,this.refreshList()},cellStyle:function(e){e.row;var t=e.column;e.rowIndex,e.columnIndex;return"name"===t.property||"number"===t.property||"customer_id"===t.property||"contract_id"===t.property||"business_id"===t.property?{color:"#3E84E9",cursor:"pointer"}:""}}},w=(i("tcal"),i("KHd+")),C=Object(w.a)(_,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ec-container"},[s("div",{staticClass:"title"},[e._v(e._s(e.infoTitle)+"\n    "),e.infoTips?s("el-tooltip",{attrs:{effect:"dark",content:e.infoTips,placement:"top"}},[s("i",{staticClass:"wukong wukong-help_tips"}),e._v(">\n    ")]):e._e()],1),e._v(" "),s("div",{staticClass:"option-bar"},[0==e.selectionList.length?s("div",[s("el-select",{attrs:{placeholder:"请选择"},on:{change:e.refreshList},model:{value:e.optionsType,callback:function(t){e.optionsType=t},expression:"optionsType"}},e._l(e.options,function(e){return s("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),e._v(" "),s("el-select",{staticStyle:{width:"120px","margin-left":"10px"},attrs:{placeholder:"请选择"},on:{change:e.refreshList},model:{value:e.isSubType,callback:function(t){e.isSubType=t},expression:"isSubType"}},e._l([{name:"我的",value:0},{name:"我下属的",value:1}],function(e){return s("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),e._v(" "),e.showFilterView?s("div",{staticClass:"filtrate-button",on:{click:e.getFilterFieldInfo}},[s("img",{staticClass:"filtrate-button-img",attrs:{src:i("3gs7")}}),e._v(" "),s("span",{staticClass:"filtrate-button-title"},[e._v("高级筛选")])]):e._e(),e._v(" "),s("filter-form",{attrs:{fieldList:e.filterFieldList,dialogVisible:e.showFilter,obj:e.filterObj,crmType:e.crmType,isSeas:!0},on:{"update:dialogVisible":function(t){e.showFilter=t},filter:e.handleFilter}})],1):s("flexbox",{staticClass:"selection-bar"},[s("div",{staticClass:"selected—title"},[e._v("已选中"),s("span",{staticClass:"selected—count"},[e._v(e._s(e.selectionList.length))]),e._v("项")]),e._v(" "),s("flexbox",{staticClass:"selection-items-box"},e._l(e.selectionButtonList,function(t,i){return s("flexbox",{key:i,staticClass:"selection-item",nativeOn:{click:function(i){e.selectionBarClick(t.type)}}},[s("img",{staticClass:"selection-item-icon",attrs:{src:t.icon}}),e._v(" "),s("div",{staticClass:"selection-item-name"},[e._v(e._s(t.name))])])}))],1)],1),e._v(" "),e.filterObj.form&&e.filterObj.form.length>0?s("filter-content",{attrs:{obj:e.filterObj},on:{delete:e.handleDeleteField}}):e._e(),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"n-table--border",staticStyle:{width:"100%"},attrs:{id:"crm-table",data:e.list,height:e.tableHeight,stripe:"",border:"","highlight-current-row":"","cell-style":e.cellStyle},on:{"row-click":e.handleRowClick,"selection-change":e.handleSelectionChange}},[e.showSelection?s("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):e._e(),e._v(" "),e._l(e.fieldList,function(t,i){return s("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",prop:t.prop,label:t.label,width:t.width,formatter:e.fieldFormatter}})}),e._v(" "),s("el-table-column",{attrs:{resizable:!1}}),e._v(" "),e.showCheckStatus?s("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"check_status_info",label:"状态",resizable:!1,width:"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("div",{staticClass:"table-head-name"},[e._v(e._s(t.column.label))])]}},{key:"default",fn:function(t){return[s("div",{staticClass:"status_button",style:e.getStatusStyle(t.row.check_status)},[e._v("\n          "+e._s(t.row.check_status_info)+"\n        ")])]}}])}):e._e()],2),e._v(" "),s("div",{staticClass:"p-contianer"},[s("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:pageSize":function(t){e.pageSize=t}}})],1),e._v(" "),s("c-r-m-all-detail",{attrs:{visible:e.showDview,crmType:e.rowType,id:e.rowID},on:{"update:visible":function(t){e.showDview=t}}})],1)},[],!1,null,"5b11e11e",null);C.options.__file="CRMMessage.vue";var A=C.exports,T=i("L2JU"),I={name:"message",components:{CRMMessage:A},watch:{messageNum:function(){this.refreshNum()}},data:function(){return{leftType:"todayCustomer",leftSides:[{name:"今日需联系客户",crmType:"customer",infoType:"todayCustomer",num:0,tips:"下次跟进时间为今日的客户",hidden:!1},{name:"分配给我的线索",crmType:"leads",infoType:"followLeads",num:0,tips:"转移之后未跟进的线索",hidden:!1},{name:"分配给我的客户",crmType:"customer",infoType:"followCustomer",num:0,tips:"转移、领取、分配之后未跟进的客户，默认显示自己负责的客户",hidden:!1},{name:"待审核合同",crmType:"contract",infoType:"checkContract",num:0,tips:"",hidden:!1},{name:"待审核回款",crmType:"receivables",infoType:"checkReceivables",num:0,tips:"",hidden:!1},{name:"待回款提醒",crmType:"receivables_plan",infoType:"remindReceivablesPlan",num:0,tips:"",hidden:!1},{name:"即将到期的合同",crmType:"contract",infoType:"endContract",num:0,tips:"根据“合同到期时间”及设置的“提前提醒天数”提醒",hidden:!1}]}},computed:n()({},Object(T.b)(["messageNum"])),mounted:function(){var e=this;this.refreshNum(),window.onresize=function(){var t=document.documentElement.clientHeight;e.$bus.emit("message-scroll",t-300)}},methods:{refreshNum:function(){for(var e=0;e<this.leftSides.length;e++){var t=this.leftSides[e];this.messageNum.hasOwnProperty(t.infoType)?(t.num=this.messageNum[t.infoType]||0,t.hidden=!1):t.hidden=!0}},messageHandle:function(e){if("follow"==e.type){var t=Object(f.h)(this.messageNum),i=parseInt(t[e.infoType])-e.value;t[e.infoType]=i>0?i:0,this.$store.commit("SET_MESSAGENUM",t)}},sideClick:function(e){this.leftType=e.infoType}}},E=(i("5Mgy"),Object(w.a)(I,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"}},[i("div",{staticClass:"message-header"},[e._v("\n    待办事项\n  ")]),e._v(" "),i("div",{staticClass:"message-body"},[i("div",{staticClass:"message-content"},[i("div",{staticClass:"message-body-side"},e._l(e.leftSides,function(t,s){return t.hidden?e._e():i("div",{key:s,staticClass:"side-item",class:e.leftType==t.infoType?"side-item-select":"side-item-default",on:{click:function(i){e.sideClick(t)}}},[e._v("\n          "+e._s(t.name)+"\n          "),t.num>0?i("el-badge",{attrs:{max:99,value:t.num}}):e._e()],1)})),e._v(" "),i("div",{staticClass:"message-body-content"},e._l(e.leftSides,function(t,s){return i("c-r-m-message",{directives:[{name:"show",rawName:"v-show",value:e.leftType==t.infoType,expression:"leftType==item.infoType"}],key:s,attrs:{crmType:t.crmType,infoType:t.infoType,infoTitle:t.name,infoTips:t.tips,show:e.leftType==t.infoType},on:{"on-handle":e.messageHandle}})}))])])])},[],!1,null,"6764d556",null));E.options.__file="Message.vue";t.default=E.exports},yNwx:function(e,t,i){"use strict";var s=i("6ZrO");i.n(s).a}}]);